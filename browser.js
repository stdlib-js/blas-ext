// Copyright (c) 2023 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
var r,n;r=this,n=function(){"use strict";var r="function"==typeof Object.defineProperty?Object.defineProperty:null,n=Object.defineProperty,f=Object.prototype,t=f.toString,u=f.__defineGetter__,e=f.__defineSetter__,i=f.__lookupGetter__,o=f.__lookupSetter__,a=function(){try{return r({},"x",{}),!0}catch(r){return!1}}()?n:function(r,n,a){var c,s,v,d;if("object"!=typeof r||null===r||"[object Array]"===t.call(r))throw new TypeError("invalid argument. First argument must be an object. Value: `"+r+"`.");if("object"!=typeof a||null===a||"[object Array]"===t.call(a))throw new TypeError("invalid argument. Property descriptor must be an object. Value: `"+a+"`.");if((s="value"in a)&&(i.call(r,n)||o.call(r,n)?(c=r.__proto__,r.__proto__=f,delete r[n],r[n]=a.value,r.__proto__=c):r[n]=a.value),v="get"in a,d="set"in a,s&&(v||d))throw new Error("invalid argument. Cannot specify one or more accessors and a value or writable attribute in the property descriptor.");return v&&u&&u.call(r,n,a.get),d&&e&&e.call(r,n,a.set),r};function c(r,n,f){a(r,n,{configurable:!1,enumerable:!0,writable:!1,value:f})}function s(r,n,f){a(r,n,{configurable:!1,enumerable:!1,writable:!1,value:f})}function v(r,n,f,t){var u,e,i;if(r<=0||0===n)return f;if(1===t){if((i=r%5)>0)for(e=0;e<i;e++)f[e]+=n;if(r<5)return f;for(e=i;e<r;e+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]+=n,u+=t;return f}function d(r){return Math.abs(r)}function y(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,a=0,c=0;c<r;c++)o=u+(i=n+f[e]),d(u)>=d(i)?a+=u-o+i:a+=i-o+u,u=o,e+=t;return u+a}function l(r,n,f,t,u){var e,i,o,a,c,s;if(r<=0)return 0;if(1===r||0===t)return n+f[u];for(i=u,e=0,c=0,s=0;s<r;s++)a=e+(o=n+f[i]),d(e)>=d(o)?c+=e-a+o:c+=o-a+e,e=a,i+=t;return e+c}function m(r,n,f,t){return y(r,n,f,t)}function p(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(i=t<0?(1-r)*t:0,u=0,e=0,o=0,y=0;y<r;y++)s=u+(c=n+f[i]),v=d(u)>=d(c)?u-s+c:c-s+u,u=s,s=o+v,a=d(o)>=d(v)?o-s+v:v-s+o,o=s,e+=a,i+=t;return u+o+e}function b(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,i=0;i<r;i++)u+=n+f[e],e+=t;return u}s(v,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0||0===n)return f;if(e=u,1===t){if((i=r%5)>0)for(o=0;o<i;o++)f[e]+=n,e+=t;if(r<5)return f;for(o=i;o<r;o+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n,e+=5;return f}for(o=0;o<r;o++)f[e]+=n,e+=t;return f})),s(y,"ndarray",l),s(m,"ndarray",(function(r,n,f,t,u){return l(r,n,f,t,u)})),s(p,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,y,l;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(o=u,e=0,i=0,a=0,l=0;l<r;l++)v=e+(s=n+f[o]),y=d(e)>=d(s)?e-v+s:s-v+e,e=v,v=a+y,c=d(a)>=d(y)?a-v+y:y-v+a,a=v,i+=c,o+=t;return e+a+i})),s(b,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(i=u,e=0,o=0;o<r;o++)e+=n+f[i],i+=t;return e}));var g=Math.floor;function w(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return n+f[u];if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return m}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return m}return p=g(r/2),w(p-=p%8,n,f,t,e)+w(r-p,n,f,t,e+p*t)}function h(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return e}return w(r,n,f,t,u)}function _(r,n,f,t){var u,e,i,o,a,c,s,v,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===f)return d(n[t]);if(u=t,r<8){for(m=0,b=0;b<r;b++)m+=d(n[u]),u+=f;return m}if(r<=128){for(e=d(n[u]),i=d(n[u+f]),o=d(n[u+2*f]),a=d(n[u+3*f]),c=d(n[u+4*f]),s=d(n[u+5*f]),v=d(n[u+6*f]),y=d(n[u+7*f]),u+=8*f,l=r%8,b=8;b<r-l;b+=8)e+=d(n[u]),i+=d(n[u+f]),o+=d(n[u+2*f]),a+=d(n[u+3*f]),c+=d(n[u+4*f]),s+=d(n[u+5*f]),v+=d(n[u+6*f]),y+=d(n[u+7*f]),u+=8*f;for(m=e+i+(o+a)+(c+s+(v+y));b<r;b++)m+=d(n[u]),u+=f;return m}return p=g(r/2),_(p-=p%8,n,f,u)+_(r-p,n,f,u+p*f)}function k(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return d(n[0]);if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=d(n[t]),t+=f;return u}return _(r,n,f,t)}function x(r,n,f,t,u,e){var i,o,a,c,s,v,y;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=n,v=0,y=0;y<r;y++)s=a+(c=f[i]),d(a)>=d(c)?v+=a-s+c:v+=c-s+a,a=s,u[o]=a+v,i+=t,o+=e;return u}function A(r,n,f,t,u,e,i,o){var a,c,s,v,y,l,m;if(r<=0)return e;for(a=u,c=o,s=n,l=0,m=0;m<r;m++)y=s+(v=f[a]),d(s)>=d(v)?l+=s-y+v:l+=v-y+s,s=y,e[c]=s+l,a+=t,c+=i;return e}function j(r,n,f,t,u,e){return x(r,n,f,t,u,e)}function S(r,n,f,t,u,e){var i,o,a,c,s,v,y,l,m;if(r<=0)return u;for(o=t<0?(1-r)*t:0,a=e<0?(1-r)*e:0,i=0,c=0,m=0;m<r;m++)y=n+(v=f[o]),l=d(n)>=d(v)?n-y+v:v-y+n,n=y,y=c+l,s=d(c)>=d(l)?c-y+l:l-y+c,c=y,i+=s,u[a]=n+c+i,o+=t,a+=e;return u}function F(r,n,f,t,u,e){var i,o,a;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=0;a<r;a++)n+=f[i],u[o]=n,i+=t,o+=e;return u}function T(r,n,f,t,u,e,i,o){var a,c,s,v,d;if(r<=0)return e;if(a=u,c=o,r<=128){for(s=0,d=0;d<r;d++)s+=f[a],e[c]=n+s,a+=t,c+=i;return e}return T(v=g(r/2),n,f,t,a,e,i,c),T(r-v,e[c+=(v-1)*i],f,t,a+v*t,e,i,c+i),e}function I(r,n,f,t,u,e){return r<=0?u:T(r,n,f,t,t<0?(1-r)*t:0,u,e,e<0?(1-r)*e:0)}function E(r,n,f,t){var u,e,i;if(r<=0)return f;if(1===t){if((i=r%8)>0)for(e=0;e<i;e++)f[e]=n;if(r<8)return f;for(e=i;e<r;e+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]=n,u+=t;return f}function O(r){return r!=r}function N(r,n,f){var t,u,e,i;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:d(n[0]);for(u=f<0?(1-r)*f:0,t=0,i=0;i<r;i++)!1===O(e=n[u])&&(t+=d(e)),u+=f;return t}function U(r,n,f,t){var u,e,i,o;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:d(n[t]);for(e=t,u=0,o=0;o<r;o++)!1===O(i=n[e])&&(u+=d(i)),e+=f;return u}function P(r,n,f){return N(r,n,f)}function M(r,n,f,t,u){var e,i,o,a,c,s,v,y;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return O(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(s=0,v=0,y=0;y<r;y++)!1===O(a=n[i])&&(c=e+a,d(e)>=d(a)?s+=e-c+a:s+=a-c+e,e=c,v+=1),i+=f;return t[o]=e+s,t[o+u]=v,t}function V(r,n,f,t,u,e,i){var o,a,c,s,v,y,l,m;if(a=t,c=i,o=0,r<=0)return u[c]=o,u[c+e]=0,u;if(1===r||0===f)return O(n[a])?(u[c]=o,u[c+e]=0,u):(u[c]=n[a],u[c+e]=1,u);for(y=0,l=0,m=0;m<r;m++)!1===O(s=n[a])&&(v=o+s,d(o)>=d(s)?y+=o-v+s:y+=s-v+o,o=v,l+=1),a+=f;return u[c]=o+y,u[c+e]=l,u}function G(r,n,f,t,u){return M(r,n,f,t,u)}function B(r,n,f,t,u){var e,i,o,a,c,s,v,y,l,m,p;if(c=f<0?(1-r)*f:0,s=u<0?-u:0,e=0,r<=0)return t[s]=e,t[s+u]=0,t;if(1===r||0===f)return O(n[c])?(t[s]=e,t[s+u]=0,t):(t[s]=n[c],t[s+u]=1,t);for(i=0,o=0,m=0,p=0;p<r;p++)!1===O(v=n[c])&&(y=e+v,l=d(e)>=d(v)?e-y+v:v-y+e,e=y,y=o+l,a=d(o)>=d(l)?o-y+l:l-y+o,o=y,i+=a,m+=1),c+=f;return t[s]=e+o+i,t[s+u]=m,t}function Y(r,n,f,t,u){var e,i,o,a,c;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return O(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(a=0,c=0;c<r;c++)!1===O(n[i])&&(e+=n[i],a+=1),i+=f;return t[o]=e,t[o+u]=a,t}function C(r,n,f,t,u,e,i){var o,a,c,s,v,d,y,l,m,p,b,w,h,_,k;if(r<=0)return u;if(o=t,a=i,1===r||0===f)return O(n[o])||(u[a]+=n[o],u[a+e]+=1),u;if(r<8){for(w=0,h=0,k=0;k<r;k++)(_=n[o])==_&&(w+=_,h+=1),o+=f;return u[a]+=w,u[a+e]+=h,u}if(r<=128){for(c=0,s=0,v=0,d=0,y=0,l=0,m=0,p=0,h=0,b=r%8,k=0;k<r-b;k+=8)(_=n[o])==_&&(c+=_,h+=1),(_=n[o+=f])==_&&(s+=_,h+=1),(_=n[o+=f])==_&&(v+=_,h+=1),(_=n[o+=f])==_&&(d+=_,h+=1),(_=n[o+=f])==_&&(y+=_,h+=1),(_=n[o+=f])==_&&(l+=_,h+=1),(_=n[o+=f])==_&&(m+=_,h+=1),(_=n[o+=f])==_&&(p+=_,h+=1),o+=f;for(w=c+s+(v+d)+(y+l+(m+p));k<r;k++)(_=n[o])==_&&(w+=_,h+=1),o+=f;return u[a]+=w,u[a+e]+=h,u}return h=g(r/2),C(h-=h%8,n,f,o,u,e,i),C(r-h,n,f,o+h*f,u,e,i),u}function q(r,n,f,t,u){var e,i;return e=f<0?(1-r)*f:0,t[i=u<0?-u:0]=0,t[i+u]=0,C(r,n,f,e,t,u,i),t}function z(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)!1===O(e=n[u])&&(i=t+e,d(t)>=d(e)?o+=t-i+e:o+=e-i+t,t=i),u+=f;return t+o}function D(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:n[t];for(e=t,u=0,a=0,c=0;c<r;c++)!1===O(i=n[e])&&(o=u+i,d(u)>=d(i)?a+=u-o+i:a+=i-o+u,u=o),e+=f;return u+a}function H(r,n,f){return z(r,n,f)}function J(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)!1===O(a=n[e])&&(c=t+a,s=d(t)>=d(a)?t-c+a:a-c+t,t=c,c=i+s,o=d(i)>=d(s)?i-c+s:s-c+i,i=c,u+=o),e+=f;return t+i+u}function K(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return O(n[0])?t:n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)!1===O(n[u])&&(t+=n[u]),u+=f;return t}function L(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===O(n[u])&&(l+=n[u]),u+=f;return l}if(r<=128){for(e=O(n[u])?0:n[u],i=O(n[u+=f])?0:n[u],o=O(n[u+=f])?0:n[u],a=O(n[u+=f])?0:n[u],c=O(n[u+=f])?0:n[u],s=O(n[u+=f])?0:n[u],v=O(n[u+=f])?0:n[u],d=O(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=O(n[u])?0:n[u],i+=O(n[u+=f])?0:n[u],o+=O(n[u+=f])?0:n[u],a+=O(n[u+=f])?0:n[u],c+=O(n[u+=f])?0:n[u],s+=O(n[u+=f])?0:n[u],v+=O(n[u+=f])?0:n[u],d+=O(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===O(n[u])&&(l+=n[u]),u+=f;return l}return m=g(r/2),L(m-=m%8,n,f,u)+L(r-m,n,f,u+m*f)}function Q(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===O(n[t])&&(u+=n[t]),t+=f;return u}return L(r,n,f,t)}function R(r,n,f){var t,u,e,i,o,a;if(r<=0)return n;if(o=g(r/2),1===f){if(e=r-1,(i=o%3)>0)for(u=0;u<i;u++)t=n[u],n[u]=n[e],n[e]=t,e-=1;if(o<3)return n;for(u=i;u<o;u+=3)t=n[u],n[u]=n[e],n[e]=t,t=n[u+1],n[u+1]=n[e-1],n[e-1]=t,t=n[u+2],n[u+2]=n[e-2],n[e-2]=t,e-=3;return n}for(e=(u=f<0?(1-r)*f:0)+(r-1)*f,a=0;a<o;a++)t=n[u],n[u]=n[e],n[e]=t,u+=f,e-=f;return n}function W(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return n+f[u];if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return m}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return m}return p=g(r/2),W(p-=p%8,n,f,t,e)+W(r-p,n,f,t,e+p*t)}function X(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return e}return W(r,n,f,t,u)}function Z(r,n,f,t){return X(r,n,f,t)}function $(r,n,f,t,u){var e,i,o,a,c;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return O(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(a=0,c=0;c<r;c++)!1===O(n[i])&&(e+=n[i],a+=1),i+=f;return t[o]=e,t[o+u]=a,t}function rr(r){return r!=r}function nr(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return rr(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===rr(n[u])&&(l+=n[u]),u+=f;return l}if(r<=128){for(e=rr(n[u])?0:n[u],i=rr(n[u+=f])?0:n[u],o=rr(n[u+=f])?0:n[u],a=rr(n[u+=f])?0:n[u],c=rr(n[u+=f])?0:n[u],s=rr(n[u+=f])?0:n[u],v=rr(n[u+=f])?0:n[u],d=rr(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=rr(n[u])?0:n[u],i+=rr(n[u+=f])?0:n[u],o+=rr(n[u+=f])?0:n[u],a+=rr(n[u+=f])?0:n[u],c+=rr(n[u+=f])?0:n[u],s+=rr(n[u+=f])?0:n[u],v+=rr(n[u+=f])?0:n[u],d+=rr(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===rr(n[u])&&(l+=n[u]),u+=f;return l}return m=g(r/2),nr(m-=m%8,n,f,u)+nr(r-m,n,f,u+m*f)}function fr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return rr(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===rr(n[t])&&(u+=n[t]),t+=f;return u}return nr(r,n,f,t)}function tr(r,n,f){return fr(r,n,f)}function ur(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return O(n[0])?t:n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)!1===O(n[u])&&(t+=n[u]),u+=f;return t}s(h,"ndarray",w),s(k,"ndarray",_),s(x,"ndarray",A),s(j,"ndarray",(function(r,n,f,t,u,e,i,o){return A(r,n,f,t,u,e,i,o)})),s(S,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,y,l,m,p,b;if(r<=0)return e;for(c=u,s=o,a=0,v=0,b=0;b<r;b++)m=n+(l=f[c]),p=d(n)>=d(l)?n-m+l:l-m+n,n=m,m=v+p,y=d(v)>=d(p)?v-m+p:p-m+v,v=m,a+=y,e[s]=n+v+a,c+=t,s+=i;return e})),s(F,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s;if(r<=0)return e;for(a=u,c=o,s=0;s<r;s++)n+=f[a],e[c]=n,a+=t,c+=i;return e})),s(I,"ndarray",T),s(E,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return f;if(e=u,1===t){if((i=r%8)>0)for(o=0;o<i;o++)f[e]=n,e+=t;if(r<8)return f;for(o=i;o<r;o+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n,e+=8;return f}for(o=0;o<r;o++)f[e]=n,e+=t;return f})),s(N,"ndarray",U),s(P,"ndarray",(function(r,n,f,t){return U(r,n,f,t)})),s(M,"ndarray",V),s(G,"ndarray",(function(r,n,f,t,u,e,i){return V(r,n,f,t,u,e,i)})),s(B,"ndarray",(function(r,n,f,t,u,e,i){var o,a,c,s,v,y,l,m,p,b,g;if(v=t,y=i,o=0,r<=0)return u[y]=o,u[y+e]=0,u;if(1===r||0===f)return O(n[v])?(u[y]=o,u[y+e]=0,u):(u[y]=n[v],u[y+e]=1,u);for(a=0,c=0,b=0,g=0;g<r;g++)!1===O(l=n[v])&&(m=o+l,p=d(o)>=d(l)?o-m+l:l-m+o,o=m,m=c+p,s=d(c)>=d(p)?c-m+p:p-m+c,c=m,a+=s,b+=1),v+=f;return u[y]=o+c+a,u[y+e]=b,u})),s(Y,"ndarray",(function(r,n,f,t,u,e,i){var o,a,c,s,v;if(a=t,c=i,o=0,r<=0)return u[c]=o,u[c+e]=0,u;if(1===r||0===f)return O(n[a])?(u[c]=o,u[c+e]=0,u):(u[c]=n[a],u[c+e]=1,u);for(s=0,v=0;v<r;v++)!1===O(n[a])&&(o+=n[a],s+=1),a+=f;return u[c]=o,u[c+e]=s,u})),s(q,"ndarray",(function(r,n,f,t,u,e,i){return u[i]=0,u[i+e]=0,C(r,n,f,t,u,e,i),u})),s(z,"ndarray",D),s(H,"ndarray",(function(r,n,f,t){return D(r,n,f,t)})),s(J,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:n[t];for(i=t,u=0,e=0,o=0,y=0;y<r;y++)!1===O(c=n[i])&&(s=u+c,v=d(u)>=d(c)?u-s+c:c-s+u,u=s,s=o+v,a=d(o)>=d(v)?o-s+v:v-s+o,o=s,e+=a),i+=f;return u+o+e})),s(K,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return O(n[t])?u:n[t];for(e=t,i=0;i<r;i++)!1===O(n[e])&&(u+=n[e]),e+=f;return u})),s(Q,"ndarray",L),s(R,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return n;if(a=g(r/2),e=t,1===f){if(i=e+r-1,(o=a%3)>0)for(c=0;c<o;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;if(a<3)return n;for(c=o;c<a;c+=3)u=n[e],n[e]=n[i],n[i]=u,u=n[e+1],n[e+1]=n[i-1],n[i-1]=u,u=n[e+2],n[e+2]=n[i-2],n[i-2]=u,e+=3,i-=3;return n}for(i=e+(r-1)*f,c=0;c<a;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;return n})),s(X,"ndarray",W),s(Z,"ndarray",(function(r,n,f,t,u){return W(r,n,f,t,u)})),s($,"ndarray",(function(r,n,f,t,u,e,i){var o,a,c,s,v;if(a=t,c=i,o=0,r<=0)return u[c]=o,u[c+e]=0,u;if(1===r||0===f)return O(n[a])?(u[c]=o,u[c+e]=0,u):(u[c]=n[a],u[c+e]=1,u);for(s=0,v=0;v<r;v++)!1===O(n[a])&&(o+=n[a],s+=1),a+=f;return u[c]=o,u[c+e]=s,u})),s(fr,"ndarray",nr),s(tr,"ndarray",(function(r,n,f,t){return nr(r,n,f,t)})),s(ur,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return O(n[t])?u:n[t];for(e=t,i=0;i<r;i++)!1===O(n[e])&&(u+=n[e]),e+=f;return u}));var er=Number.POSITIVE_INFINITY;function ir(r){return 0===r&&1/r===er}function or(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,w;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,p=r,a=g(r/2);;){if(a>0)d=f[i+(a-=1)*t],y=u[o+a*e];else{if(0==(p-=1))return f;d=f[l=i+p*t],y=u[m=o+p*e],f[l]=f[i],u[m]=u[o]}for(c=2*(b=a)+1;c<p&&((w=c+1)<p&&((s=f[i+w*t])>(v=f[i+c*t])||O(s)||s===v&&ir(s))&&(c+=1),(s=f[i+c*t])>d||O(s)||s===d&&ir(s));)f[i+b*t]=s,u[o+b*e]=u[o+c*e],c=2*(b=c)+1;f[i+b*t]=d,u[o+b*e]=y}}s(or,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,w;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),p=r,a=g(r/2);;){if(a>0)d=f[u+(a-=1)*t],y=e[o+a*i];else{if(0==(p-=1))return f;d=f[l=u+p*t],y=e[m=o+p*i],f[l]=f[u],e[m]=e[o]}for(c=2*(b=a)+1;c<p&&((w=c+1)<p&&((s=f[u+w*t])>(v=f[u+c*t])||O(s)||s===v&&ir(s))&&(c+=1),(s=f[u+c*t])>d||O(s)||s===d&&ir(s));)f[u+b*t]=s,e[o+b*i]=e[o+c*i],c=2*(b=c)+1;f[u+b*t]=d,e[o+b*i]=y}}));var ar=Number.NEGATIVE_INFINITY;function cr(r){return 0===r&&1/r===ar}function sr(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;if(n<0&&(t*=-1,e*=-1),e<0?(y=(1-r)*e,l=0):(y=0,l=(r-1)*e),v=y+e,t<0){for(s=0,o=(c=(1-r)*t)+t,g=1;g<r;g++)if(m=f[o],p=u[v],O(m)){for(a=o,d=v;a>s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=cr(m),a=o-t,d=v-e;a<=c&&(!((b=f[a])<=m)||i&&b===m&&!1===cr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}for(s=(r-1)*t,o=(c=0)+t,g=1;g<r;g++)if(m=f[o],p=u[v],O(m)){for(a=o,d=v;a<s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=cr(m),a=o-t,d=v-e;a>=c&&(!((b=f[a])<=m)||i&&b===m&&!1===cr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}s(sr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g,w,h;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),d=(v=u)+(r-1)*t,c=v+t,p=(m=o)+(r-1)*i,y=m+i,t<0){for(h=1;h<r;h++)if(b=f[c],g=e[y],O(b)){for(s=c,l=y;s>d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=cr(b),s=c-t,l=y-i;s<=v&&(!((w=f[s])<=b)||a&&w===b&&!1===cr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}for(h=1;h<r;h++)if(b=f[c],g=e[y],O(b)){for(s=c,l=y;s<d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=cr(b),s=c-t,l=y-i;s>=v&&(!((w=f[s])<=b)||a&&w===b&&!1===cr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}));var vr=[701,301,132,57,23,10,4,1],dr=vr.length;function yr(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,y=0;y<dr;y++)for(l=c=vr[y];l<r;l++)if(!O(s=f[i+l*t])){for(v=u[o+l*e],a=cr(s),m=l;m>=c&&(!((d=f[i+(m-c)*t])<=s)||a&&d===s);m-=c)f[i+m*t]=d,u[o+m*e]=u[o+(m-c)*e];f[i+m*t]=s,u[o+m*e]=v}return f}var lr=vr.length;function mr(r,n,f,t){var u,e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=r,e=g(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||O(o)||o===a&&ir(o))&&(i+=1),(o=f[u+i*t])>s||O(o)||o===s&&ir(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}}function pr(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;if(n<0&&(t*=-1),t<0){for(a=0,e=(o=(1-r)*t)+t,v=1;v<r;v++)if(O(c=f[e])){for(i=e;i>a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=cr(c),i=e-t;i<=o&&(!((s=f[i])<=c)||u&&s===c&&!1===cr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}for(a=(r-1)*t,e=(o=0)+t,v=1;v<r;v++)if(O(c=f[e])){for(i=e;i<a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=cr(c),i=e-t;i>=o&&(!((s=f[i])<=c)||u&&s===c&&!1===cr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}s(yr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),y=0;y<lr;y++)for(l=c=vr[y];l<r;l++)if(!O(s=f[u+l*t])){for(v=e[o+l*i],a=cr(s),m=l;m>=c&&(!((d=f[u+(m-c)*t])<=s)||a&&d===s);m-=c)f[u+m*t]=d,e[o+m*i]=e[o+(m-c)*i];f[u+m*t]=s,e[o+m*i]=v}return f})),s(mr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=r,e=g(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||O(o)||o===a&&ir(o))&&(i+=1),(o=f[u+i*t])>s||O(o)||o===s&&ir(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}})),s(pr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1)),c=(a=u)+(r-1)*t,i=a+t,t<0){for(d=1;d<r;d++)if(O(s=f[i])){for(o=i;o>c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=cr(s),o=i-t;o<=a&&(!((v=f[o])<=s)||e&&v===s&&!1===cr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}for(d=1;d<r;d++)if(O(s=f[i])){for(o=i;o<c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=cr(s),o=i-t;o>=a&&(!((v=f[o])<=s)||e&&v===s&&!1===cr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}));var br=[701,301,132,57,23,10,4,1],gr=br.length;function wr(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=0;c<gr;c++)for(s=i=br[c];s<r;s++)if(!O(o=f[u+s*t])){for(e=cr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f}var hr=br.length;function _r(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return l}return m=g(r/2),_r(m-=m%8,n,f,u)+_r(r-m,n,f,u+m*f)}function kr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return u}return _r(r,n,f,t)}function xr(r,n,f){return kr(r,n,f)}function Ar(r,n,f){var t,u,e,i;if(t=0,r<=0)return t;if(1===r||0===f)return n[0];if(1===f){if((e=r%6)>0)for(i=0;i<e;i++)t+=n[i];if(r<6)return t;for(i=e;i<r;i+=6)t+=n[i]+n[i+1]+n[i+2]+n[i+3]+n[i+4]+n[i+5];return t}for(u=f<0?(1-r)*f:0,i=0;i<r;i++)t+=n[u],u+=f;return t}function jr(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)i=t+(e=n[u]),d(t)>=d(e)?o+=t-i+e:o+=e-i+t,t=i,u+=f;return t+o}function Sr(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return n[t];for(e=t,u=0,a=0,c=0;c<r;c++)o=u+(i=n[e]),d(u)>=d(i)?a+=u-o+i:a+=i-o+u,u=o,e+=f;return u+a}function Fr(r,n,f){return jr(r,n,f)}function Tr(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)c=t+(a=n[e]),s=d(t)>=d(a)?t-c+a:a-c+t,t=c,c=i+s,o=d(i)>=d(s)?i-c+s:s-c+i,i=c,u+=o,e+=f;return t+i+u}function Ir(r,n,f){var t,u,e,i;if(t=0,r<=0)return t;if(1===r||0===f)return n[0];if(1===f){if((e=r%6)>0)for(i=0;i<e;i++)t+=n[i];if(r<6)return t;for(i=e;i<r;i+=6)t+=n[i]+n[i+1]+n[i+2]+n[i+3]+n[i+4]+n[i+5];return t}for(u=f<0?(1-r)*f:0,i=0;i<r;i++)t+=n[u],u+=f;return t}function Er(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return l}return m=g(r/2),Er(m-=m%8,n,f,u)+Er(r-m,n,f,u+m*f)}function Or(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return u}return Er(r,n,f,t)}function Nr(r,n,f,t){var u,e,i;if(r<=0||0===n)return f;if(1===t){if((i=r%5)>0)for(e=0;e<i;e++)f[e]+=n;if(r<5)return f;for(e=i;e<r;e+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]+=n,u+=t;return f}function Ur(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,a=0,c=0;c<r;c++)o=u+(i=n+f[e]),d(u)>=d(i)?a+=u-o+i:a+=i-o+u,u=o,e+=t;return u+a}function Pr(r,n,f,t,u){var e,i,o,a,c,s;if(r<=0)return 0;if(1===r||0===t)return n+f[u];for(i=u,e=0,c=0,s=0;s<r;s++)a=e+(o=n+f[i]),d(e)>=d(o)?c+=e-a+o:c+=o-a+e,e=a,i+=t;return e+c}function Mr(r,n,f,t){return Ur(r,n,f,t)}function Vr(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(i=t<0?(1-r)*t:0,u=0,e=0,o=0,y=0;y<r;y++)s=u+(c=n+f[i]),v=d(u)>=d(c)?u-s+c:c-s+u,u=s,s=o+v,a=d(o)>=d(v)?o-s+v:v-s+o,o=s,e+=a,i+=t;return u+o+e}function Gr(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,i=0;i<r;i++)u+=n+f[e],e+=t;return u}function Br(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return n+f[u];if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return m}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return m}return p=g(r/2),Br(p-=p%8,n,f,t,e)+Br(r-p,n,f,t,e+p*t)}function Yr(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return e}return Br(r,n,f,t,u)}function Cr(r,n,f,t){var u,e,i,o,a,c,s,v,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===f)return d(n[t]);if(u=t,r<8){for(m=0,b=0;b<r;b++)m+=d(n[u]),u+=f;return m}if(r<=128){for(e=d(n[u]),i=d(n[u+f]),o=d(n[u+2*f]),a=d(n[u+3*f]),c=d(n[u+4*f]),s=d(n[u+5*f]),v=d(n[u+6*f]),y=d(n[u+7*f]),u+=8*f,l=r%8,b=8;b<r-l;b+=8)e+=d(n[u]),i+=d(n[u+f]),o+=d(n[u+2*f]),a+=d(n[u+3*f]),c+=d(n[u+4*f]),s+=d(n[u+5*f]),v+=d(n[u+6*f]),y+=d(n[u+7*f]),u+=8*f;for(m=e+i+(o+a)+(c+s+(v+y));b<r;b++)m+=d(n[u]),u+=f;return m}return p=g(r/2),Cr(p-=p%8,n,f,u)+Cr(r-p,n,f,u+p*f)}function qr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return d(n[0]);if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=d(n[t]),t+=f;return u}return Cr(r,n,f,t)}function zr(r,n,f,t,u,e){var i,o,a,c,s,v,y;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=n,v=0,y=0;y<r;y++)s=a+(c=f[i]),d(a)>=d(c)?v+=a-s+c:v+=c-s+a,a=s,u[o]=a+v,i+=t,o+=e;return u}function Dr(r,n,f,t,u,e,i,o){var a,c,s,v,y,l,m;if(r<=0)return e;for(a=u,c=o,s=n,l=0,m=0;m<r;m++)y=s+(v=f[a]),d(s)>=d(v)?l+=s-y+v:l+=v-y+s,s=y,e[c]=s+l,a+=t,c+=i;return e}function Hr(r,n,f,t,u,e){return zr(r,n,f,t,u,e)}function Jr(r,n,f,t,u,e){var i,o,a,c,s,v,y,l,m;if(r<=0)return u;for(o=t<0?(1-r)*t:0,a=e<0?(1-r)*e:0,i=0,c=0,m=0;m<r;m++)y=n+(v=f[o]),l=d(n)>=d(v)?n-y+v:v-y+n,n=y,y=c+l,s=d(c)>=d(l)?c-y+l:l-y+c,c=y,i+=s,u[a]=n+c+i,o+=t,a+=e;return u}function Kr(r,n,f,t,u,e){var i,o,a;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=0;a<r;a++)n+=f[i],u[o]=n,i+=t,o+=e;return u}function Lr(r,n,f,t,u,e,i,o){var a,c,s,v,d;if(r<=0)return e;if(a=u,c=o,r<=128){for(s=0,d=0;d<r;d++)s+=f[a],e[c]=n+s,a+=t,c+=i;return e}return Lr(v=g(r/2),n,f,t,a,e,i,c),Lr(r-v,e[c+=(v-1)*i],f,t,a+v*t,e,i,c+i),e}function Qr(r,n,f,t,u,e){return r<=0?u:Lr(r,n,f,t,t<0?(1-r)*t:0,u,e,e<0?(1-r)*e:0)}function Rr(r,n){return r[n]}function Wr(r,n){return r.get(n)}function Xr(r,n,f){r[n]=f}function Zr(r,n,f){r.set(f,n)}function $r(r){var n=Boolean(r.get&&r.set);return{data:r,accessors:n,getter:n?Wr:Rr,setter:n?Zr:Xr}}function rn(r,n,f,t,u){var e,i,o,a;for(e=f.data,i=f.setter,o=u,a=0;a<r;a++)i(e,o,n),o+=t;return f}function nn(r,n,f,t){var u,e,i,o;if(r<=0)return f;if((o=$r(f)).accessors)return rn(r,n,o,t,u=t<0?(1-r)*t:0),o.data;if(1===t){if((i=r%8)>0)for(e=0;e<i;e++)f[e]=n;if(r<8)return f;for(e=i;e<r;e+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]=n,u+=t;return f}function fn(r,n,f,t,u,e){var i,o,a,c,s;for(i=n.data,a=n.getter,o=n.setter,c=t,s=0;s<r;s++)o(i,c,u.call(e,a(i,c),s,c,n)),c+=f;return n}function tn(r,n,f,t,u){var e,i,o;if(r<=0)return n;if(e=f<0?(1-r)*f:0,(i=$r(n)).accessors)return fn(r,i,f,e,t,u),i.data;for(o=0;o<r;o++)n[e]=t.call(u,n[e],o,e,n),e+=f;return n}function un(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)!1===O(e=n[u])&&(i=t+e,d(t)>=d(e)?o+=t-i+e:o+=e-i+t,t=i),u+=f;return t+o}function en(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:n[t];for(e=t,u=0,a=0,c=0;c<r;c++)!1===O(i=n[e])&&(o=u+i,d(u)>=d(i)?a+=u-o+i:a+=i-o+u,u=o),e+=f;return u+a}function on(r,n,f){return un(r,n,f)}function an(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)!1===O(a=n[e])&&(c=t+a,s=d(t)>=d(a)?t-c+a:a-c+t,t=c,c=i+s,o=d(i)>=d(s)?i-c+s:s-c+i,i=c,u+=o),e+=f;return t+i+u}function cn(r,n,f){var t,u,e;if(u=0,r<=0)return u;if(1===r||0===f)return O(n[0])?u:n[0];for(t=f<0?(1-r)*f:0,e=0;e<r;e++)!1===O(n[t])&&(u+=n[t]),t+=f;return u}function sn(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===O(n[u])&&(l+=n[u]),u+=f;return l}if(r<=128){for(e=O(n[u])?0:n[u],i=O(n[u+=f])?0:n[u],o=O(n[u+=f])?0:n[u],a=O(n[u+=f])?0:n[u],c=O(n[u+=f])?0:n[u],s=O(n[u+=f])?0:n[u],v=O(n[u+=f])?0:n[u],d=O(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=O(n[u])?0:n[u],i+=O(n[u+=f])?0:n[u],o+=O(n[u+=f])?0:n[u],a+=O(n[u+=f])?0:n[u],c+=O(n[u+=f])?0:n[u],s+=O(n[u+=f])?0:n[u],v+=O(n[u+=f])?0:n[u],d+=O(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===O(n[u])&&(l+=n[u]),u+=f;return l}return m=g(r/2),sn(m-=m%8,n,f,u)+sn(r-m,n,f,u+m*f)}function vn(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return O(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===O(n[t])&&(u+=n[t]),t+=f;return u}return sn(r,n,f,t)}function dn(r,n,f,t){var u,e,i,o,a,c,s,v;for(u=n.data,e=n.setter,i=n.getter,s=g(r/2),c=(a=t)+(r-1)*f,v=0;v<s;v++)o=i(u,a),e(u,a,i(u,c)),e(u,c,o),a+=f,c-=f;return n}function yn(r,n,f){var t,u,e,i,o,a,c;if(r<=0)return n;if((i=$r(n)).accessors)return dn(r,i,f,u=f<0?(1-r)*f:0),i.data;if(a=g(r/2),1===f){if(e=r-1,(o=a%3)>0)for(u=0;u<o;u++)t=n[u],n[u]=n[e],n[e]=t,e-=1;if(a<3)return n;for(u=o;u<a;u+=3)t=n[u],n[u]=n[e],n[e]=t,t=n[u+1],n[u+1]=n[e-1],n[e-1]=t,t=n[u+2],n[u+2]=n[e-2],n[e-2]=t,e-=3;return n}for(e=(u=f<0?(1-r)*f:0)+(r-1)*f,c=0;c<a;c++)t=n[u],n[u]=n[e],n[e]=t,u+=f,e-=f;return n}function ln(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,w;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,p=r,a=g(r/2);;){if(a>0)d=f[i+(a-=1)*t],y=u[o+a*e];else{if(0==(p-=1))return f;d=f[l=i+p*t],y=u[m=o+p*e],f[l]=f[i],u[m]=u[o]}for(c=2*(b=a)+1;c<p&&((w=c+1)<p&&((s=f[i+w*t])>(v=f[i+c*t])||O(s)||s===v&&ir(s))&&(c+=1),(s=f[i+c*t])>d||O(s)||s===d&&ir(s));)f[i+b*t]=s,u[o+b*e]=u[o+c*e],c=2*(b=c)+1;f[i+b*t]=d,u[o+b*e]=y}}function mn(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;if(n<0&&(t*=-1,e*=-1),e<0?(y=(1-r)*e,l=0):(y=0,l=(r-1)*e),v=y+e,t<0){for(s=0,o=(c=(1-r)*t)+t,g=1;g<r;g++)if(m=f[o],p=u[v],O(m)){for(a=o,d=v;a>s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=cr(m),a=o-t,d=v-e;a<=c&&(!((b=f[a])<=m)||i&&b===m&&!1===cr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}for(s=(r-1)*t,o=(c=0)+t,g=1;g<r;g++)if(m=f[o],p=u[v],O(m)){for(a=o,d=v;a<s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=cr(m),a=o-t,d=v-e;a>=c&&(!((b=f[a])<=m)||i&&b===m&&!1===cr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}s(wr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=0;c<hr;c++)for(s=i=br[c];s<r;s++)if(!O(o=f[u+s*t])){for(e=cr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f})),s(kr,"ndarray",_r),s(xr,"ndarray",(function(r,n,f,t){return _r(r,n,f,t)})),s(Ar,"ndarray",(function(r,n,f,t){var u,e,i,o;if(u=0,r<=0)return u;if(1===r||0===f)return n[t];if(e=t,1===f){if((i=r%6)>0)for(o=0;o<i;o++)u+=n[e],e+=f;if(r<6)return u;for(o=i;o<r;o+=6)u+=n[e]+n[e+1]+n[e+2]+n[e+3]+n[e+4]+n[e+5],e+=6;return u}for(o=0;o<r;o++)u+=n[e],e+=f;return u})),s(jr,"ndarray",Sr),s(Fr,"ndarray",(function(r,n,f,t){return Sr(r,n,f,t)})),s(Tr,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===f)return n[t];for(i=t,u=0,e=0,o=0,y=0;y<r;y++)s=u+(c=n[i]),v=d(u)>=d(c)?u-s+c:c-s+u,u=s,s=o+v,a=d(o)>=d(v)?o-s+v:v-s+o,o=s,e+=a,i+=f;return u+o+e})),s(Ir,"ndarray",(function(r,n,f,t){var u,e,i,o;if(u=0,r<=0)return u;if(1===r||0===f)return n[t];if(e=t,1===f){if((i=r%6)>0)for(o=0;o<i;o++)u+=n[e],e+=f;if(r<6)return u;for(o=i;o<r;o+=6)u+=n[e]+n[e+1]+n[e+2]+n[e+3]+n[e+4]+n[e+5],e+=6;return u}for(o=0;o<r;o++)u+=n[e],e+=f;return u})),s(Or,"ndarray",Er),s(Nr,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0||0===n)return f;if(e=u,1===t){if((i=r%5)>0)for(o=0;o<i;o++)f[e]+=n,e+=t;if(r<5)return f;for(o=i;o<r;o+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n,e+=5;return f}for(o=0;o<r;o++)f[e]+=n,e+=t;return f})),s(Ur,"ndarray",Pr),s(Mr,"ndarray",(function(r,n,f,t,u){return Pr(r,n,f,t,u)})),s(Vr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,y,l;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(o=u,e=0,i=0,a=0,l=0;l<r;l++)v=e+(s=n+f[o]),y=d(e)>=d(s)?e-v+s:s-v+e,e=v,v=a+y,c=d(a)>=d(y)?a-v+y:y-v+a,a=v,i+=c,o+=t;return e+a+i})),s(Gr,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return 0;if(1===r||0===t)return n+f[u];for(i=u,e=0,o=0;o<r;o++)e+=n+f[i],i+=t;return e})),s(Yr,"ndarray",Br),s(qr,"ndarray",Cr),s(zr,"ndarray",Dr),s(Hr,"ndarray",(function(r,n,f,t,u,e,i,o){return Dr(r,n,f,t,u,e,i,o)})),s(Jr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,y,l,m,p,b;if(r<=0)return e;for(c=u,s=o,a=0,v=0,b=0;b<r;b++)m=n+(l=f[c]),p=d(n)>=d(l)?n-m+l:l-m+n,n=m,m=v+p,y=d(v)>=d(p)?v-m+p:p-m+v,v=m,a+=y,e[s]=n+v+a,c+=t,s+=i;return e})),s(Kr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s;if(r<=0)return e;for(a=u,c=o,s=0;s<r;s++)n+=f[a],e[c]=n,a+=t,c+=i;return e})),s(Qr,"ndarray",Lr),s(nn,"ndarray",(function(r,n,f,t,u){var e,i,o,a;if(r<=0)return f;if((o=$r(f)).accessors)return rn(r,n,o,t,u),o.data;if(e=u,1===t){if((i=r%8)>0)for(a=0;a<i;a++)f[e]=n,e+=t;if(r<8)return f;for(a=i;a<r;a+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n,e+=8;return f}for(a=0;a<r;a++)f[e]=n,e+=t;return f})),s(tn,"ndarray",(function(r,n,f,t,u,e){var i,o,a;if(r<=0)return n;if((o=$r(n)).accessors)return fn(r,o,f,t,u,e),o.data;for(i=t,a=0;a<r;a++)n[i]=u.call(e,n[i],a,i,n),i+=f;return n})),s(un,"ndarray",en),s(on,"ndarray",(function(r,n,f,t){return en(r,n,f,t)})),s(an,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===f)return O(n[t])?0:n[t];for(i=t,u=0,e=0,o=0,y=0;y<r;y++)!1===O(c=n[i])&&(s=u+c,v=d(u)>=d(c)?u-s+c:c-s+u,u=s,s=o+v,a=d(o)>=d(v)?o-s+v:v-s+o,o=s,e+=a),i+=f;return u+o+e})),s(cn,"ndarray",(function(r,n,f,t){var u,e,i;if(e=0,r<=0)return e;if(1===r||0===f)return O(n[t])?e:n[t];for(u=t,i=0;i<r;i++)!1===O(n[u])&&(e+=n[u]),u+=f;return e})),s(vn,"ndarray",sn),s(yn,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s;if(r<=0)return n;if((o=$r(n)).accessors)return dn(r,o,f,t),o.data;if(c=g(r/2),e=t,1===f){if(i=e+r-1,(a=c%3)>0)for(s=0;s<a;s++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;if(c<3)return n;for(s=a;s<c;s+=3)u=n[e],n[e]=n[i],n[i]=u,u=n[e+1],n[e+1]=n[i-1],n[i-1]=u,u=n[e+2],n[e+2]=n[i-2],n[i-2]=u,e+=3,i-=3;return n}for(i=e+(r-1)*f,s=0;s<c;s++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;return n})),s(ln,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,w;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),p=r,a=g(r/2);;){if(a>0)d=f[u+(a-=1)*t],y=e[o+a*i];else{if(0==(p-=1))return f;d=f[l=u+p*t],y=e[m=o+p*i],f[l]=f[u],e[m]=e[o]}for(c=2*(b=a)+1;c<p&&((w=c+1)<p&&((s=f[u+w*t])>(v=f[u+c*t])||O(s)||s===v&&ir(s))&&(c+=1),(s=f[u+c*t])>d||O(s)||s===d&&ir(s));)f[u+b*t]=s,e[o+b*i]=e[o+c*i],c=2*(b=c)+1;f[u+b*t]=d,e[o+b*i]=y}})),s(mn,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g,w,h;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),d=(v=u)+(r-1)*t,c=v+t,p=(m=o)+(r-1)*i,y=m+i,t<0){for(h=1;h<r;h++)if(b=f[c],g=e[y],O(b)){for(s=c,l=y;s>d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=cr(b),s=c-t,l=y-i;s<=v&&(!((w=f[s])<=b)||a&&w===b&&!1===cr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}for(h=1;h<r;h++)if(b=f[c],g=e[y],O(b)){for(s=c,l=y;s<d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=cr(b),s=c-t,l=y-i;s>=v&&(!((w=f[s])<=b)||a&&w===b&&!1===cr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}));var pn=[701,301,132,57,23,10,4,1],bn=pn.length;function gn(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,y=0;y<bn;y++)for(l=c=pn[y];l<r;l++)if(!O(s=f[i+l*t])){for(v=u[o+l*e],a=cr(s),m=l;m>=c&&(!((d=f[i+(m-c)*t])<=s)||a&&d===s);m-=c)f[i+m*t]=d,u[o+m*e]=u[o+(m-c)*e];f[i+m*t]=s,u[o+m*e]=v}return f}var wn=pn.length;function hn(r,n,f,t){var u,e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=r,e=g(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||O(o)||o===a&&ir(o))&&(i+=1),(o=f[u+i*t])>s||O(o)||o===s&&ir(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}}function _n(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;if(n<0&&(t*=-1),t<0){for(a=0,e=(o=(1-r)*t)+t,v=1;v<r;v++)if(O(c=f[e])){for(i=e;i>a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=cr(c),i=e-t;i<=o&&(!((s=f[i])<=c)||u&&s===c&&!1===cr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}for(a=(r-1)*t,e=(o=0)+t,v=1;v<r;v++)if(O(c=f[e])){for(i=e;i<a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=cr(c),i=e-t;i>=o&&(!((s=f[i])<=c)||u&&s===c&&!1===cr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}s(gn,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),y=0;y<wn;y++)for(l=c=pn[y];l<r;l++)if(!O(s=f[u+l*t])){for(v=e[o+l*i],a=cr(s),m=l;m>=c&&(!((d=f[u+(m-c)*t])<=s)||a&&d===s);m-=c)f[u+m*t]=d,e[o+m*i]=e[o+(m-c)*i];f[u+m*t]=s,e[o+m*i]=v}return f})),s(hn,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=r,e=g(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||O(o)||o===a&&ir(o))&&(i+=1),(o=f[u+i*t])>s||O(o)||o===s&&ir(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}})),s(_n,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1)),c=(a=u)+(r-1)*t,i=a+t,t<0){for(d=1;d<r;d++)if(O(s=f[i])){for(o=i;o>c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=cr(s),o=i-t;o<=a&&(!((v=f[o])<=s)||e&&v===s&&!1===cr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}for(d=1;d<r;d++)if(O(s=f[i])){for(o=i;o<c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=cr(s),o=i-t;o>=a&&(!((v=f[o])<=s)||e&&v===s&&!1===cr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}));var kn=[701,301,132,57,23,10,4,1],xn=kn.length;function An(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=0;c<xn;c++)for(s=i=kn[c];s<r;s++)if(!O(o=f[u+s*t])){for(e=cr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f}var jn=kn.length;function Sn(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)i=t+(e=n[u]),d(t)>=d(e)?o+=t-i+e:o+=e-i+t,t=i,u+=f;return t+o}function Fn(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return n[t];for(e=t,u=0,a=0,c=0;c<r;c++)o=u+(i=n[e]),d(u)>=d(i)?a+=u-o+i:a+=i-o+u,u=o,e+=f;return u+a}function Tn(r,n,f){return Sn(r,n,f)}function In(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)c=t+(a=n[e]),s=d(t)>=d(a)?t-c+a:a-c+t,t=c,c=i+s,o=d(i)>=d(s)?i-c+s:s-c+i,i=c,u+=o,e+=f;return t+i+u}function En(r,n,f){var t,u,e,i;if(e=0,r<=0)return e;if(1===r||0===f)return n[0];if(1===f){if((u=r%6)>0)for(i=0;i<u;i++)e+=n[i];if(r<6)return e;for(i=u;i<r;i+=6)e+=n[i]+n[i+1]+n[i+2]+n[i+3]+n[i+4]+n[i+5];return e}for(t=f<0?(1-r)*f:0,i=0;i<r;i++)e+=n[t],t+=f;return e}function On(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return l}return m=g(r/2),On(m-=m%8,n,f,u)+On(r-m,n,f,u+m*f)}function Nn(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return u}return On(r,n,f,t)}function Un(r,n,f,t){var u,e,i;if(r<=0||0===n)return f;if(1===t){if((i=r%5)>0)for(e=0;e<i;e++)f[e]+=n;if(r<5)return f;for(e=i;e<r;e+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]+=n,u+=t;return f}s(An,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=0;c<jn;c++)for(s=i=kn[c];s<r;s++)if(!O(o=f[u+s*t])){for(e=cr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f})),s(Sn,"ndarray",Fn),s(Tn,"ndarray",(function(r,n,f,t){return Fn(r,n,f,t)})),s(In,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===f)return n[t];for(i=t,u=0,e=0,o=0,y=0;y<r;y++)s=u+(c=n[i]),v=d(u)>=d(c)?u-s+c:c-s+u,u=s,s=o+v,a=d(o)>=d(v)?o-s+v:v-s+o,o=s,e+=a,i+=f;return u+o+e})),s(En,"ndarray",(function(r,n,f,t){var u,e,i,o;if(i=0,r<=0)return i;if(1===r||0===f)return n[t];if(u=t,1===f){if((e=r%6)>0)for(o=0;o<e;o++)i+=n[u],u+=f;if(r<6)return i;for(o=e;o<r;o+=6)i+=n[u]+n[u+1]+n[u+2]+n[u+3]+n[u+4]+n[u+5],u+=6;return i}for(o=0;o<r;o++)i+=n[u],u+=f;return i})),s(Nn,"ndarray",On),s(Un,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0||0===n)return f;if(e=u,1===t){if((i=r%5)>0)for(o=0;o<i;o++)f[e]+=n,e+=t;if(r<5)return f;for(o=i;o<r;o+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n,e+=5;return f}for(o=0;o<r;o++)f[e]+=n,e+=t;return f}));var Pn,Mn="function"==typeof Math.fround?Math.fround:null,Vn="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),Gn=Object.prototype.toString,Bn=Object.prototype.hasOwnProperty,Yn="function"==typeof Symbol?Symbol.toStringTag:"";Pn=Vn&&"symbol"==typeof Symbol.toStringTag?function(r){var n,f,t,u,e;if(null==r)return Gn.call(r);f=r[Yn],e=Yn,n=null!=(u=r)&&Bn.call(u,e);try{r[Yn]=void 0}catch(n){return Gn.call(r)}return t=Gn.call(r),n?r[Yn]=f:delete r[Yn],t}:function(r){return Gn.call(r)};var Cn=Pn,qn="function"==typeof Float32Array,zn="function"==typeof Float32Array?Float32Array:null,Dn="function"==typeof Float32Array?Float32Array:void 0,Hn=function(){var r,n,f;if("function"!=typeof zn)return!1;try{n=new zn([1,3.14,-3.14,5e40]),f=n,r=(qn&&f instanceof Float32Array||"[object Float32Array]"===Cn(f))&&1===n[0]&&3.140000104904175===n[1]&&-3.140000104904175===n[2]&&n[3]===er}catch(n){r=!1}return r}()?Dn:function(){throw new Error("not implemented")},Jn=new Hn(1),Kn="function"==typeof Mn?Mn:function(r){return Jn[0]=r,Jn[0]};function Ln(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[0]);for(e=t<0?(1-r)*t:0,u=0,a=0,c=0;c<r;c++)i=Kn(n+f[e]),o=Kn(u+i),a=d(u)>=d(i)?Kn(a+Kn(Kn(u-o)+i)):Kn(a+Kn(Kn(i-o)+u)),u=o,e+=t;return Kn(u+a)}function Qn(r,n,f,t,u){var e,i,o,a,c,s;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[u]);for(i=u,e=0,c=0,s=0;s<r;s++)o=Kn(n+f[i]),a=Kn(e+o),c=d(e)>=d(o)?Kn(c+Kn(Kn(e-a)+o)):Kn(c+Kn(Kn(o-a)+e)),e=a,i+=t;return Kn(e+c)}function Rn(r,n,f,t){return Ln(r,n,f,t)}function Wn(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[0]);for(i=t<0?(1-r)*t:0,u=0,e=0,o=0,y=0;y<r;y++)c=Kn(n+f[i]),s=Kn(u+c),v=d(u)>=d(c)?Kn(Kn(u-s)+c):Kn(Kn(c-s)+u),u=s,s=Kn(o+v),a=d(o)>=d(v)?Kn(Kn(o-s)+v):Kn(Kn(v-s)+o),o=s,e=Kn(e+a),i+=t;return Kn(u+Kn(o+e))}function Xn(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[0]);for(e=t<0?(1-r)*t:0,u=0,i=0;i<r;i++)u=Kn(u+Kn(n+f[e])),e+=t;return u}function Zn(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[u]);if(e=u,r<8){for(m=0,b=0;b<r;b++)m=Kn(m+Kn(n+f[e])),e+=t;return m}if(r<=128){for(i=Kn(n+f[e]),o=Kn(n+f[e+t]),a=Kn(n+f[e+2*t]),c=Kn(n+f[e+3*t]),s=Kn(n+f[e+4*t]),v=Kn(n+f[e+5*t]),d=Kn(n+f[e+6*t]),y=Kn(n+f[e+7*t]),e+=8*t,l=r%8,b=8;b<r-l;b+=8)i=Kn(i+Kn(n+f[e])),o=Kn(o+Kn(n+f[e+t])),a=Kn(a+Kn(n+f[e+2*t])),c=Kn(c+Kn(n+f[e+3*t])),s=Kn(s+Kn(n+f[e+4*t])),v=Kn(v+Kn(n+f[e+5*t])),d=Kn(d+Kn(n+f[e+6*t])),y=Kn(y+Kn(n+f[e+7*t])),e+=8*t;for(m=Kn(Kn(Kn(i+o)+Kn(a+c))+Kn(Kn(s+v)+Kn(d+y)));b<r;b++)m=Kn(m+Kn(n+f[e])),e+=t;return m}return p=g(r/2),Kn(Zn(p-=p%8,n,f,t,e)+Zn(r-p,n,f,t,e+p*t))}function $n(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[0]);if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e=Kn(e+Kn(n+f[u])),u+=t;return e}return Zn(r,n,f,t,u)}function rf(r,n,f,t){var u,e,i,o,a,c,s,v,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===f)return d(n[t]);if(u=t,r<8){for(m=0,b=0;b<r;b++)m=Kn(m+d(n[u])),u+=f;return m}if(r<=128){for(e=d(n[u]),i=d(n[u+f]),o=d(n[u+2*f]),a=d(n[u+3*f]),c=d(n[u+4*f]),s=d(n[u+5*f]),v=d(n[u+6*f]),y=d(n[u+7*f]),u+=8*f,l=r%8,b=8;b<r-l;b+=8)e=Kn(e+d(n[u])),i=Kn(i+d(n[u+f])),o=Kn(o+d(n[u+2*f])),a=Kn(a+d(n[u+3*f])),c=Kn(c+d(n[u+4*f])),s=Kn(s+d(n[u+5*f])),v=Kn(v+d(n[u+6*f])),y=Kn(y+d(n[u+7*f])),u+=8*f;for(m=Kn(Kn(Kn(e+i)+Kn(o+a))+Kn(Kn(c+s)+Kn(v+y)));b<r;b++)m=Kn(m+d(n[u])),u+=f;return m}return p=g(r/2),Kn(rf(p-=p%8,n,f,u)+rf(r-p,n,f,u+p*f))}function nf(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return d(n[0]);if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u=Kn(u+d(n[t])),t+=f;return u}return rf(r,n,f,t)}function ff(r,n,f,t,u,e){var i,o,a,c,s,v,y;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=n,v=0,y=0;y<r;y++)c=f[i],s=Kn(a+c),v=d(a)>=d(c)?Kn(v+Kn(Kn(a-s)+c)):Kn(v+Kn(Kn(c-s)+a)),a=s,u[o]=Kn(a+v),i+=t,o+=e;return u}function tf(r,n,f,t,u,e,i,o){var a,c,s,v,y,l,m;if(r<=0)return e;for(a=u,c=o,s=n,l=0,m=0;m<r;m++)v=f[a],y=Kn(s+v),l=d(s)>=d(v)?Kn(l+Kn(Kn(s-y)+v)):Kn(l+Kn(Kn(v-y)+s)),s=y,e[c]=Kn(s+l),a+=t,c+=i;return e}function uf(r,n,f,t,u,e){return ff(r,n,f,t,u,e)}function ef(r,n,f,t,u,e){var i,o,a,c,s,v,y,l,m;if(r<=0)return u;for(o=t<0?(1-r)*t:0,a=e<0?(1-r)*e:0,i=0,c=0,m=0;m<r;m++)v=f[o],y=Kn(n+v),l=d(n)>=d(v)?Kn(Kn(n-y)+v):Kn(Kn(v-y)+n),n=y,y=Kn(c+l),s=d(c)>=d(l)?Kn(Kn(c-y)+l):Kn(Kn(l-y)+c),c=y,i=Kn(i+s),u[a]=Kn(n+Kn(c+i)),o+=t,a+=e;return u}function of(r,n,f,t,u,e){var i,o,a;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=0;a<r;a++)n=Kn(n+f[i]),u[o]=n,i+=t,o+=e;return u}function af(r,n,f,t,u,e,i,o){var a,c,s,v,d;if(r<=0)return e;if(a=u,c=o,r<=128){for(s=0,d=0;d<r;d++)s=Kn(s+f[a]),e[c]=Kn(n+s),a+=t,c+=i;return e}return af(v=g(r/2),n,f,t,a,e,i,c),af(r-v,e[c+=(v-1)*i],f,t,a+v*t,e,i,c+i),e}function cf(r,n,f,t,u,e){return r<=0?u:af(r,n,f,t,t<0?(1-r)*t:0,u,e,e<0?(1-r)*e:0)}function sf(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[u]);if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return Kn(m)}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return Kn(m)}return p=g(r/2),Kn(sf(p-=p%8,n,f,t,e)+sf(r-p,n,f,t,e+p*t))}function vf(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[0]);if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return Kn(e)}return sf(r,n,f,t,u)}function df(r,n,f,t){return vf(r,n,f,t)}function yf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return rr(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===rr(n[u])&&(l+=n[u]),u+=f;return Kn(l)}if(r<=128){for(e=rr(n[u])?0:n[u],i=rr(n[u+=f])?0:n[u],o=rr(n[u+=f])?0:n[u],a=rr(n[u+=f])?0:n[u],c=rr(n[u+=f])?0:n[u],s=rr(n[u+=f])?0:n[u],v=rr(n[u+=f])?0:n[u],d=rr(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=rr(n[u])?0:n[u],i+=rr(n[u+=f])?0:n[u],o+=rr(n[u+=f])?0:n[u],a+=rr(n[u+=f])?0:n[u],c+=rr(n[u+=f])?0:n[u],s+=rr(n[u+=f])?0:n[u],v+=rr(n[u+=f])?0:n[u],d+=rr(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===rr(n[u])&&(l+=n[u]),u+=f;return Kn(l)}return m=g(r/2),Kn(yf(m-=m%8,n,f,u)+yf(r-m,n,f,u+m*f))}function lf(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return rr(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===rr(n[t])&&(u+=n[t]),t+=f;return Kn(u)}return yf(r,n,f,t)}function mf(r,n,f){return lf(r,n,f)}function pf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return Kn(l)}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return Kn(l)}return m=g(r/2),Kn(pf(m-=m%8,n,f,u)+pf(r-m,n,f,u+m*f))}function bf(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return Kn(u)}return pf(r,n,f,t)}function gf(r,n,f){return bf(r,n,f)}function wf(r,n,f,t){var u,e,i;if(r<=0)return f;if(1===t){if((i=r%8)>0)for(e=0;e<i;e++)f[e]=n;if(r<8)return f;for(e=i;e<r;e+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]=n,u+=t;return f}function hf(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return rr(n[0])?0:n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)!1===rr(e=n[u])&&(i=t+e,o=d(t)>=d(e)?Kn(o+Kn(Kn(t-i)+e)):Kn(o+Kn(Kn(e-i)+t)),t=i),u+=f;return Kn(t+o)}function _f(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return rr(n[t])?0:n[t];for(e=t,u=0,a=0,c=0;c<r;c++)!1===rr(i=n[e])&&(o=u+i,a=d(u)>=d(i)?Kn(a+Kn(Kn(u-o)+i)):Kn(a+Kn(Kn(i-o)+u)),u=o),e+=f;return Kn(u+a)}function kf(r,n,f){return hf(r,n,f)}function xf(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return rr(n[0])?0:n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)!1===rr(a=n[e])&&(c=Kn(t+a),s=d(t)>=d(a)?Kn(Kn(t-c)+a):Kn(Kn(a-c)+t),t=c,c=Kn(i+s),o=d(i)>=d(s)?Kn(Kn(i-c)+s):Kn(Kn(s-c)+i),i=c,u=Kn(u+o)),e+=f;return Kn(t+Kn(i+u))}function Af(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return rr(n[0])?t:n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)!1===rr(n[u])&&(t=Kn(t+n[u])),u+=f;return t}function jf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return rr(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===rr(n[u])&&(l=Kn(l+n[u])),u+=f;return l}if(r<=128){for(e=rr(n[u])?0:n[u],i=rr(n[u+=f])?0:n[u],o=rr(n[u+=f])?0:n[u],a=rr(n[u+=f])?0:n[u],c=rr(n[u+=f])?0:n[u],s=rr(n[u+=f])?0:n[u],v=rr(n[u+=f])?0:n[u],d=rr(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e=rr(n[u])?e:Kn(e+n[u]),i=rr(n[u+=f])?i:Kn(i+n[u]),o=rr(n[u+=f])?o:Kn(o+n[u]),a=rr(n[u+=f])?a:Kn(a+n[u]),c=rr(n[u+=f])?c:Kn(c+n[u]),s=rr(n[u+=f])?s:Kn(s+n[u]),v=rr(n[u+=f])?v:Kn(v+n[u]),d=rr(n[u+=f])?d:Kn(d+n[u]),u+=f;for(l=Kn(Kn(Kn(e+i)+Kn(o+a))+Kn(Kn(c+s)+Kn(v+d)));p<r;p++)!1===rr(n[u])&&(l=Kn(l+n[u])),u+=f;return l}return m=g(r/2),Kn(jf(m-=m%8,n,f,u)+jf(r-m,n,f,u+m*f))}function Sf(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return rr(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===rr(n[t])&&(u=Kn(u+n[t])),t+=f;return u}return jf(r,n,f,t)}function Ff(r,n,f){var t,u,e,i,o,a;if(r<=0)return n;if(o=g(r/2),1===f){if(e=r-1,(i=o%3)>0)for(u=0;u<i;u++)t=n[u],n[u]=n[e],n[e]=t,e-=1;if(o<3)return n;for(u=i;u<o;u+=3)t=n[u],n[u]=n[e],n[e]=t,t=n[u+1],n[u+1]=n[e-1],n[e-1]=t,t=n[u+2],n[u+2]=n[e-2],n[e-2]=t,e-=3;return n}for(e=(u=f<0?(1-r)*f:0)+(r-1)*f,a=0;a<o;a++)t=n[u],n[u]=n[e],n[e]=t,u+=f,e-=f;return n}s(Ln,"ndarray",Qn),s(Rn,"ndarray",(function(r,n,f,t,u){return Qn(r,n,f,t,u)})),s(Wn,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,y,l;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[u]);for(o=u,e=0,i=0,a=0,l=0;l<r;l++)s=Kn(n+f[o]),v=Kn(e+s),y=d(e)>=d(s)?Kn(Kn(e-v)+s):Kn(Kn(s-v)+e),e=v,v=Kn(a+y),c=d(a)>=d(y)?Kn(Kn(a-v)+y):Kn(Kn(y-v)+a),a=v,i=Kn(i+c),o+=t;return Kn(e+Kn(a+i))})),s(Xn,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return 0;if(1===r||0===t)return Kn(n+f[0]);for(i=u,e=0,o=0;o<r;o++)e=Kn(e+Kn(n+f[i])),i+=t;return e})),s($n,"ndarray",Zn),s(nf,"ndarray",rf),s(ff,"ndarray",tf),s(uf,"ndarray",(function(r,n,f,t,u,e,i,o){return tf(r,n,f,t,u,e,i,o)})),s(ef,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,y,l,m,p,b;if(r<=0)return e;for(c=u,s=o,a=0,v=0,b=0;b<r;b++)l=f[c],m=Kn(n+l),p=d(n)>=d(l)?Kn(Kn(n-m)+l):Kn(Kn(l-m)+n),n=m,m=Kn(v+p),y=d(v)>=d(p)?Kn(Kn(v-m)+p):Kn(Kn(p-m)+v),v=m,a=Kn(a+y),e[s]=Kn(n+Kn(v+a)),c+=t,s+=i;return e})),s(of,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s;if(r<=0)return e;for(a=u,c=o,s=0;s<r;s++)n=Kn(n+f[a]),e[c]=n,a+=t,c+=i;return e})),s(cf,"ndarray",af),s(vf,"ndarray",sf),s(df,"ndarray",(function(r,n,f,t,u){return sf(r,n,f,t,u)})),s(lf,"ndarray",yf),s(mf,"ndarray",(function(r,n,f,t){return yf(r,n,f,t)})),s(bf,"ndarray",pf),s(gf,"ndarray",(function(r,n,f,t){return pf(r,n,f,t)})),s(wf,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return f;if(e=u,1===t){if((i=r%8)>0)for(o=0;o<i;o++)f[e]=n,e+=t;if(r<8)return f;for(o=i;o<r;o+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n,e+=8;return f}for(o=0;o<r;o++)f[e]=n,e+=t;return f})),s(hf,"ndarray",_f),s(kf,"ndarray",(function(r,n,f,t){return _f(r,n,f,t)})),s(xf,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===f)return rr(n[t])?0:n[t];for(i=t,u=0,e=0,o=0,y=0;y<r;y++)!1===rr(c=n[i])&&(s=Kn(u+c),v=d(u)>=d(c)?Kn(Kn(u-s)+c):Kn(Kn(c-s)+u),u=s,s=Kn(o+v),a=d(o)>=d(v)?Kn(Kn(o-s)+v):Kn(Kn(v-s)+o),o=s,e=Kn(e+a)),i+=f;return Kn(u+Kn(o+e))})),s(Af,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return rr(n[t])?u:n[t];for(e=t,i=0;i<r;i++)!1===rr(n[e])&&(u=Kn(u+n[e])),e+=f;return u})),s(Sf,"ndarray",jf),s(Ff,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return n;if(a=g(r/2),e=t,1===f){if(i=e+r-1,(o=a%3)>0)for(c=0;c<o;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;if(a<3)return n;for(c=o;c<a;c+=3)u=n[e],n[e]=n[i],n[i]=u,u=n[e+1],n[e+1]=n[i-1],n[i-1]=u,u=n[e+2],n[e+2]=n[i-2],n[i-2]=u,e+=3,i-=3;return n}for(i=e+(r-1)*f,c=0;c<a;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;return n}));var Tf="function"==typeof Uint32Array,If="function"==typeof Uint32Array?Uint32Array:null,Ef="function"==typeof Uint32Array?Uint32Array:void 0,Of=function(){var r,n,f;if("function"!=typeof If)return!1;try{n=new If(n=[1,3.14,-3.14,4294967296,4294967297]),f=n,r=(Tf&&f instanceof Uint32Array||"[object Uint32Array]"===Cn(f))&&1===n[0]&&3===n[1]&&4294967293===n[2]&&0===n[3]&&1===n[4]}catch(n){r=!1}return r}()?Ef:function(){throw new Error("not implemented")},Nf=new Hn(1);new Of(Nf.buffer)[0]=2139095040;var Uf=Nf[0];function Pf(r){return 0===r&&1/r===Uf}function Mf(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,w;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,p=r,a=g(r/2);;){if(a>0)d=f[i+(a-=1)*t],y=u[o+a*e];else{if(0==(p-=1))return f;d=f[l=i+p*t],y=u[m=o+p*e],f[l]=f[i],u[m]=u[o]}for(c=2*(b=a)+1;c<p&&((w=c+1)<p&&((s=f[i+w*t])>(v=f[i+c*t])||rr(s)||s===v&&Pf(s))&&(c+=1),(s=f[i+c*t])>d||rr(s)||s===d&&Pf(s));)f[i+b*t]=s,u[o+b*e]=u[o+c*e],c=2*(b=c)+1;f[i+b*t]=d,u[o+b*e]=y}}s(Mf,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,w;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),p=r,a=g(r/2);;){if(a>0)d=f[u+(a-=1)*t],y=e[o+a*i];else{if(0==(p-=1))return f;d=f[l=u+p*t],y=e[m=o+p*i],f[l]=f[u],e[m]=e[o]}for(c=2*(b=a)+1;c<p&&((w=c+1)<p&&((s=f[u+w*t])>(v=f[u+c*t])||rr(s)||s===v&&Pf(s))&&(c+=1),(s=f[u+c*t])>d||rr(s)||s===d&&Pf(s));)f[u+b*t]=s,e[o+b*i]=e[o+c*i],c=2*(b=c)+1;f[u+b*t]=d,e[o+b*i]=y}}));var Vf=new Hn(1);new Of(Vf.buffer)[0]=4286578688;var Gf=Vf[0];function Bf(r){return 0===r&&1/r===Gf}function Yf(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;if(n<0&&(t*=-1,e*=-1),e<0?(y=(1-r)*e,l=0):(y=0,l=(r-1)*e),v=y+e,t<0){for(s=0,o=(c=(1-r)*t)+t,g=1;g<r;g++)if(m=f[o],p=u[v],rr(m)){for(a=o,d=v;a>s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=Bf(m),a=o-t,d=v-e;a<=c&&(!((b=f[a])<=m)||i&&b===m&&!1===Bf(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}for(s=(r-1)*t,o=(c=0)+t,g=1;g<r;g++)if(m=f[o],p=u[v],rr(m)){for(a=o,d=v;a<s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=Bf(m),a=o-t,d=v-e;a>=c&&(!((b=f[a])<=m)||i&&b===m&&!1===Bf(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}s(Yf,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g,w,h;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),d=(v=u)+(r-1)*t,c=v+t,p=(m=o)+(r-1)*i,y=m+i,t<0){for(h=1;h<r;h++)if(b=f[c],g=e[y],rr(b)){for(s=c,l=y;s>d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=Bf(b),s=c-t,l=y-i;s<=v&&(!((w=f[s])<=b)||a&&w===b&&!1===Bf(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}for(h=1;h<r;h++)if(b=f[c],g=e[y],rr(b)){for(s=c,l=y;s<d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=Bf(b),s=c-t,l=y-i;s>=v&&(!((w=f[s])<=b)||a&&w===b&&!1===Bf(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}));var Cf=[701,301,132,57,23,10,4,1],qf=Cf.length;function zf(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,y=0;y<qf;y++)for(l=c=Cf[y];l<r;l++)if(!rr(s=f[i+l*t])){for(v=u[o+l*e],a=Bf(s),m=l;m>=c&&(!((d=f[i+(m-c)*t])<=s)||a&&d===s);m-=c)f[i+m*t]=d,u[o+m*e]=u[o+(m-c)*e];f[i+m*t]=s,u[o+m*e]=v}return f}var Df=Cf.length;function Hf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=r,e=g(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||rr(o)||o===a&&Pf(o))&&(i+=1),(o=f[u+i*t])>s||rr(o)||o===s&&Pf(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}}function Jf(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;if(n<0&&(t*=-1),t<0){for(a=0,e=(o=(1-r)*t)+t,v=1;v<r;v++)if(rr(c=f[e])){for(i=e;i>a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=Bf(c),i=e-t;i<=o&&(!((s=f[i])<=c)||u&&s===c&&!1===Bf(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}for(a=(r-1)*t,e=(o=0)+t,v=1;v<r;v++)if(rr(c=f[e])){for(i=e;i<a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=Bf(c),i=e-t;i>=o&&(!((s=f[i])<=c)||u&&s===c&&!1===Bf(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}s(zf,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),y=0;y<Df;y++)for(l=c=Cf[y];l<r;l++)if(!rr(s=f[u+l*t])){for(v=e[o+l*i],a=Bf(s),m=l;m>=c&&(!((d=f[u+(m-c)*t])<=s)||a&&d===s);m-=c)f[u+m*t]=d,e[o+m*i]=e[o+(m-c)*i];f[u+m*t]=s,e[o+m*i]=v}return f})),s(Hf,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=r,e=g(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||rr(o)||o===a&&Pf(o))&&(i+=1),(o=f[u+i*t])>s||rr(o)||o===s&&Pf(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}})),s(Jf,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1)),c=(a=u)+(r-1)*t,i=a+t,t<0){for(d=1;d<r;d++)if(rr(s=f[i])){for(o=i;o>c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=Bf(s),o=i-t;o<=a&&(!((v=f[o])<=s)||e&&v===s&&!1===Bf(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}for(d=1;d<r;d++)if(rr(s=f[i])){for(o=i;o<c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=Bf(s),o=i-t;o>=a&&(!((v=f[o])<=s)||e&&v===s&&!1===Bf(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}));var Kf=[701,301,132,57,23,10,4,1],Lf=Kf.length;function Qf(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=0;c<Lf;c++)for(s=i=Kf[c];s<r;s++)if(!rr(o=f[u+s*t])){for(e=Bf(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f}var Rf=Kf.length;function Wf(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)e=n[u],i=Kn(t+e),o=d(t)>=d(e)?Kn(o+Kn(Kn(t-i)+e)):Kn(o+Kn(Kn(e-i)+t)),t=i,u+=f;return Kn(t+o)}function Xf(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return n[t];for(e=t,u=0,a=0,c=0;c<r;c++)i=n[e],o=Kn(u+i),a=d(u)>=d(i)?Kn(a+Kn(Kn(u-o)+i)):Kn(a+Kn(Kn(i-o)+u)),u=o,e+=f;return Kn(u+a)}function Zf(r,n,f){return Wf(r,n,f)}function $f(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)a=n[e],c=Kn(t+a),s=d(t)>=d(a)?Kn(Kn(t-c)+a):Kn(Kn(a-c)+t),t=c,c=Kn(i+s),o=d(i)>=d(s)?Kn(Kn(i-c)+s):Kn(Kn(s-c)+i),i=c,u=Kn(u+o),e+=f;return Kn(t+Kn(i+u))}function rt(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)t=Kn(t+n[u]),u+=f;return t}function nt(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l=Kn(l+n[u]),u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e=Kn(e+n[u]),i=Kn(i+n[u+f]),o=Kn(o+n[u+2*f]),a=Kn(a+n[u+3*f]),c=Kn(c+n[u+4*f]),s=Kn(s+n[u+5*f]),v=Kn(v+n[u+6*f]),d=Kn(d+n[u+7*f]),u+=8*f;for(l=Kn(Kn(Kn(e+i)+Kn(o+a))+Kn(Kn(c+s)+Kn(v+d)));p<r;p++)l=Kn(l+n[u]),u+=f;return l}return m=g(r/2),Kn(nt(m-=m%8,n,f,u)+nt(r-m,n,f,u+m*f))}function ft(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u=Kn(u+n[t]),t+=f;return u}return nt(r,n,f,t)}s(Qf,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=0;c<Rf;c++)for(s=i=Kf[c];s<r;s++)if(!rr(o=f[u+s*t])){for(e=Bf(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f})),s(Wf,"ndarray",Xf),s(Zf,"ndarray",(function(r,n,f,t){return Xf(r,n,f,t)})),s($f,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,y;if(r<=0)return 0;if(1===r||0===f)return n[t];for(i=t,u=0,e=0,o=0,y=0;y<r;y++)c=n[i],s=Kn(u+c),v=d(u)>=d(c)?Kn(Kn(u-s)+c):Kn(Kn(c-s)+u),u=s,s=Kn(o+v),a=d(o)>=d(v)?Kn(Kn(o-s)+v):Kn(Kn(v-s)+o),o=s,e=Kn(e+a),i+=f;return Kn(u+Kn(o+e))})),s(rt,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return n[t];for(e=t,i=0;i<r;i++)u=Kn(u+n[e]),e+=f;return u})),s(ft,"ndarray",nt);var tt={};c(tt,"dapx",v),c(tt,"dapxsum",m),c(tt,"dapxsumkbn",y),c(tt,"dapxsumkbn2",p),c(tt,"dapxsumors",b),c(tt,"dapxsumpw",h),c(tt,"dasumpw",k),c(tt,"dcusum",j),c(tt,"dcusumkbn",x),c(tt,"dcusumkbn2",S),c(tt,"dcusumors",F),c(tt,"dcusumpw",I),c(tt,"dfill",E),c(tt,"dnanasum",P),c(tt,"dnanasumors",N),c(tt,"dnannsum",G),c(tt,"dnannsumkbn",M),c(tt,"dnannsumkbn2",B),c(tt,"dnannsumors",Y),c(tt,"dnannsumpw",q),c(tt,"dnansum",H),c(tt,"dnansumkbn",z),c(tt,"dnansumkbn2",J),c(tt,"dnansumors",K),c(tt,"dnansumpw",Q),c(tt,"drev",R),c(tt,"dsapxsum",Z),c(tt,"dsapxsumpw",X),c(tt,"dsnannsumors",$),c(tt,"dsnansum",tr),c(tt,"dsnansumors",ur),c(tt,"dsnansumpw",fr),c(tt,"dsort2hp",or),c(tt,"dsort2ins",sr),c(tt,"dsort2sh",yr),c(tt,"dsorthp",mr),c(tt,"dsortins",pr),c(tt,"dsortsh",wr),c(tt,"dssum",xr),c(tt,"dssumors",Ar),c(tt,"dssumpw",kr),c(tt,"dsum",Fr),c(tt,"dsumkbn",jr),c(tt,"dsumkbn2",Tr),c(tt,"dsumors",Ir),c(tt,"dsumpw",Or),c(tt,"gapx",Nr),c(tt,"gapxsum",Mr),c(tt,"gapxsumkbn",Ur),c(tt,"gapxsumkbn2",Vr),c(tt,"gapxsumors",Gr),c(tt,"gapxsumpw",Yr),c(tt,"gasumpw",qr),c(tt,"gcusum",Hr),c(tt,"gcusumkbn",zr),c(tt,"gcusumkbn2",Jr),c(tt,"gcusumors",Kr),c(tt,"gcusumpw",Qr),c(tt,"gfill",nn),c(tt,"gfillBy",tn),c(tt,"gnannsumkbn",(function(r,n,f,t,u){var e,i,o,a,c,s,v,y;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return O(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(s=0,v=0,y=0;y<r;y++)!1===O(a=n[i])&&(c=e+a,d(e)>=d(a)?s+=e-c+a:s+=a-c+e,e=c,v+=1),i+=f;return t[o]=e+s,t[o+u]=v,t})),c(tt,"gnansum",on),c(tt,"gnansumkbn",un),c(tt,"gnansumkbn2",an),c(tt,"gnansumors",cn),c(tt,"gnansumpw",vn),c(tt,"grev",yn),c(tt,"gsort2hp",ln),c(tt,"gsort2ins",mn),c(tt,"gsort2sh",gn),c(tt,"gsorthp",hn),c(tt,"gsortins",_n),c(tt,"gsortsh",An),c(tt,"gsum",Tn),c(tt,"gsumkbn",Sn),c(tt,"gsumkbn2",In),c(tt,"gsumors",En),c(tt,"gsumpw",Nn),c(tt,"sapx",Un),c(tt,"sapxsum",Rn),c(tt,"sapxsumkbn",Ln),c(tt,"sapxsumkbn2",Wn),c(tt,"sapxsumors",Xn),c(tt,"sapxsumpw",$n),c(tt,"sasumpw",nf),c(tt,"scusum",uf),c(tt,"scusumkbn",ff),c(tt,"scusumkbn2",ef),c(tt,"scusumors",of),c(tt,"scusumpw",cf),c(tt,"sdsapxsum",df),c(tt,"sdsapxsumpw",vf),c(tt,"sdsnansum",mf),c(tt,"sdsnansumpw",lf),c(tt,"sdssum",gf),c(tt,"sdssumpw",bf),c(tt,"sfill",wf),c(tt,"snansum",kf),c(tt,"snansumkbn",hf),c(tt,"snansumkbn2",xf),c(tt,"snansumors",Af),c(tt,"snansumpw",Sf),c(tt,"srev",Ff),c(tt,"ssort2hp",Mf),c(tt,"ssort2ins",Yf),c(tt,"ssort2sh",zf),c(tt,"ssorthp",Hf),c(tt,"ssortins",Jf),c(tt,"ssortsh",Qf),c(tt,"ssum",Zf),c(tt,"ssumkbn",Wf),c(tt,"ssumkbn2",$f),c(tt,"ssumors",rt),c(tt,"ssumpw",ft);var ut={};return c(ut,"base",tt),ut},"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r="undefined"!=typeof globalThis?globalThis:r||self).extblas=n();
//# sourceMappingURL=browser.js.map
