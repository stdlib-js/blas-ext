// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
var r,n;r=this,n=function(r){"use strict";var n="function"==typeof Object.defineProperty?Object.defineProperty:null,f=Object.defineProperty,t=Object.prototype,u=t.toString,e=t.__defineGetter__,i=t.__defineSetter__,o=t.__lookupGetter__,a=t.__lookupSetter__,c=function(){try{return n({},"x",{}),!0}catch(r){return!1}}()?f:function(r,n,f){var c,s,v,d;if("object"!=typeof r||null===r||"[object Array]"===u.call(r))throw new TypeError("invalid argument. First argument must be an object. Value: `"+r+"`.");if("object"!=typeof f||null===f||"[object Array]"===u.call(f))throw new TypeError("invalid argument. Property descriptor must be an object. Value: `"+f+"`.");if((s="value"in f)&&(o.call(r,n)||a.call(r,n)?(c=r.__proto__,r.__proto__=t,delete r[n],r[n]=f.value,r.__proto__=c):r[n]=f.value),v="get"in f,d="set"in f,s&&(v||d))throw new Error("invalid argument. Cannot specify one or more accessors and a value or writable attribute in the property descriptor.");return v&&e&&e.call(r,n,f.get),d&&i&&i.call(r,n,f.set),r};function s(r,n,f){c(r,n,{configurable:!1,enumerable:!0,writable:!1,value:f})}function v(r,n,f){c(r,n,{configurable:!1,enumerable:!1,writable:!1,value:f})}function d(r,n,f,t){var u,e,i;if(r<=0||0===n)return f;if(1===t){if((i=r%5)>0)for(e=0;e<i;e++)f[e]+=n;if(r<5)return f;for(e=i;e<r;e+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]+=n,u+=t;return f}function y(r){return Math.abs(r)}function l(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,a=0,c=0;c<r;c++)o=u+(i=n+f[e]),y(u)>=y(i)?a+=u-o+i:a+=i-o+u,u=o,e+=t;return u+a}function m(r,n,f,t,u){var e,i,o,a,c,s;if(r<=0)return 0;if(1===r||0===t)return n+f[u];for(i=u,e=0,c=0,s=0;s<r;s++)a=e+(o=n+f[i]),y(e)>=y(o)?c+=e-a+o:c+=o-a+e,e=a,i+=t;return e+c}function p(r,n,f,t){return l(r,n,f,t)}function b(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(i=t<0?(1-r)*t:0,u=0,e=0,o=0,d=0;d<r;d++)s=u+(c=n+f[i]),v=y(u)>=y(c)?u-s+c:c-s+u,u=s,s=o+v,a=y(o)>=y(v)?o-s+v:v-s+o,o=s,e+=a,i+=t;return u+o+e}function g(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,i=0;i<r;i++)u+=n+f[e],e+=t;return u}v(d,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0||0===n)return f;if(e=u,1===t){if((i=r%5)>0)for(o=0;o<i;o++)f[e]+=n,e+=t;if(r<5)return f;for(o=i;o<r;o+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n,e+=5;return f}for(o=0;o<r;o++)f[e]+=n,e+=t;return f})),v(l,"ndarray",m),v(p,"ndarray",(function(r,n,f,t,u){return m(r,n,f,t,u)})),v(b,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,l;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(o=u,e=0,i=0,a=0,l=0;l<r;l++)v=e+(s=n+f[o]),d=y(e)>=y(s)?e-v+s:s-v+e,e=v,v=a+d,c=y(a)>=y(d)?a-v+d:d-v+a,a=v,i+=c,o+=t;return e+a+i})),v(g,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(i=u,e=0,o=0;o<r;o++)e+=n+f[i],i+=t;return e}));var w=Math.floor;function h(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return n+f[u];if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return m}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return m}return p=w(r/2),h(p-=p%8,n,f,t,e)+h(r-p,n,f,t,e+p*t)}function _(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return e}return h(r,n,f,t,u)}function k(r,n,f,t){var u,e,i,o,a,c,s,v,d,l,m,p,b;if(r<=0)return 0;if(1===r||0===f)return y(n[t]);if(u=t,r<8){for(m=0,b=0;b<r;b++)m+=y(n[u]),u+=f;return m}if(r<=128){for(e=y(n[u]),i=y(n[u+f]),o=y(n[u+2*f]),a=y(n[u+3*f]),c=y(n[u+4*f]),s=y(n[u+5*f]),v=y(n[u+6*f]),d=y(n[u+7*f]),u+=8*f,l=r%8,b=8;b<r-l;b+=8)e+=y(n[u]),i+=y(n[u+f]),o+=y(n[u+2*f]),a+=y(n[u+3*f]),c+=y(n[u+4*f]),s+=y(n[u+5*f]),v+=y(n[u+6*f]),d+=y(n[u+7*f]),u+=8*f;for(m=e+i+(o+a)+(c+s+(v+d));b<r;b++)m+=y(n[u]),u+=f;return m}return p=w(r/2),k(p-=p%8,n,f,u)+k(r-p,n,f,u+p*f)}function x(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return y(n[0]);if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=y(n[t]),t+=f;return u}return k(r,n,f,t)}function A(r,n,f,t,u,e){var i,o,a,c,s,v,d;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=n,v=0,d=0;d<r;d++)s=a+(c=f[i]),y(a)>=y(c)?v+=a-s+c:v+=c-s+a,a=s,u[o]=a+v,i+=t,o+=e;return u}function j(r,n,f,t,u,e,i,o){var a,c,s,v,d,l,m;if(r<=0)return e;for(a=u,c=o,s=n,l=0,m=0;m<r;m++)d=s+(v=f[a]),y(s)>=y(v)?l+=s-d+v:l+=v-d+s,s=d,e[c]=s+l,a+=t,c+=i;return e}function S(r,n,f,t,u,e){return A(r,n,f,t,u,e)}function F(r,n,f,t,u,e){var i,o,a,c,s,v,d,l,m;if(r<=0)return u;for(o=t<0?(1-r)*t:0,a=e<0?(1-r)*e:0,i=0,c=0,m=0;m<r;m++)d=n+(v=f[o]),l=y(n)>=y(v)?n-d+v:v-d+n,n=d,d=c+l,s=y(c)>=y(l)?c-d+l:l-d+c,c=d,i+=s,u[a]=n+c+i,o+=t,a+=e;return u}function T(r,n,f,t,u,e){var i,o,a;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=0;a<r;a++)n+=f[i],u[o]=n,i+=t,o+=e;return u}function I(r,n,f,t,u,e,i,o){var a,c,s,v,d;if(r<=0)return e;if(a=u,c=o,r<=128){for(s=0,d=0;d<r;d++)s+=f[a],e[c]=n+s,a+=t,c+=i;return e}return I(v=w(r/2),n,f,t,a,e,i,c),I(r-v,e[c+=(v-1)*i],f,t,a+v*t,e,i,c+i),e}function O(r,n,f,t,u,e){return r<=0?u:I(r,n,f,t,t<0?(1-r)*t:0,u,e,e<0?(1-r)*e:0)}function E(r,n,f,t){var u,e,i;if(r<=0)return f;if(1===t){if((i=r%8)>0)for(e=0;e<i;e++)f[e]=n;if(r<8)return f;for(e=i;e<r;e+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]=n,u+=t;return f}function N(r){return r!=r}function P(r,n,f){var t,u,e,i;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:y(n[0]);for(u=f<0?(1-r)*f:0,t=0,i=0;i<r;i++)!1===N(e=n[u])&&(t+=y(e)),u+=f;return t}function U(r,n,f,t){var u,e,i,o;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:y(n[t]);for(e=t,u=0,o=0;o<r;o++)!1===N(i=n[e])&&(u+=y(i)),e+=f;return u}function M(r,n,f){return P(r,n,f)}function V(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return N(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(s=0,v=0,d=0;d<r;d++)!1===N(a=n[i])&&(c=e+a,y(e)>=y(a)?s+=e-c+a:s+=a-c+e,e=c,v+=1),i+=f;return t[o]=e+s,t[o+u]=v,t}function G(r,n,f,t,u,e,i){var o,a,c,s,v,d,l,m;if(a=t,c=i,o=0,r<=0)return u[c]=o,u[c+e]=0,u;if(1===r||0===f)return N(n[a])?(u[c]=o,u[c+e]=0,u):(u[c]=n[a],u[c+e]=1,u);for(d=0,l=0,m=0;m<r;m++)!1===N(s=n[a])&&(v=o+s,y(o)>=y(s)?d+=o-v+s:d+=s-v+o,o=v,l+=1),a+=f;return u[c]=o+d,u[c+e]=l,u}function B(r,n,f,t,u){return V(r,n,f,t,u)}function Y(r,n,f,t,u){var e,i,o,a,c,s,v,d,l,m,p;if(c=f<0?(1-r)*f:0,s=u<0?-u:0,e=0,r<=0)return t[s]=e,t[s+u]=0,t;if(1===r||0===f)return N(n[c])?(t[s]=e,t[s+u]=0,t):(t[s]=n[c],t[s+u]=1,t);for(i=0,o=0,m=0,p=0;p<r;p++)!1===N(v=n[c])&&(d=e+v,l=y(e)>=y(v)?e-d+v:v-d+e,e=d,d=o+l,a=y(o)>=y(l)?o-d+l:l-d+o,o=d,i+=a,m+=1),c+=f;return t[s]=e+o+i,t[s+u]=m,t}function C(r,n,f,t,u){var e,i,o,a,c;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return N(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(a=0,c=0;c<r;c++)!1===N(n[i])&&(e+=n[i],a+=1),i+=f;return t[o]=e,t[o+u]=a,t}function q(r,n,f,t,u,e,i){var o,a,c,s,v,d,y,l,m,p,b,g,h,_,k;if(r<=0)return u;if(o=t,a=i,1===r||0===f)return N(n[o])||(u[a]+=n[o],u[a+e]+=1),u;if(r<8){for(g=0,h=0,k=0;k<r;k++)(_=n[o])==_&&(g+=_,h+=1),o+=f;return u[a]+=g,u[a+e]+=h,u}if(r<=128){for(c=0,s=0,v=0,d=0,y=0,l=0,m=0,p=0,h=0,b=r%8,k=0;k<r-b;k+=8)(_=n[o])==_&&(c+=_,h+=1),(_=n[o+=f])==_&&(s+=_,h+=1),(_=n[o+=f])==_&&(v+=_,h+=1),(_=n[o+=f])==_&&(d+=_,h+=1),(_=n[o+=f])==_&&(y+=_,h+=1),(_=n[o+=f])==_&&(l+=_,h+=1),(_=n[o+=f])==_&&(m+=_,h+=1),(_=n[o+=f])==_&&(p+=_,h+=1),o+=f;for(g=c+s+(v+d)+(y+l+(m+p));k<r;k++)(_=n[o])==_&&(g+=_,h+=1),o+=f;return u[a]+=g,u[a+e]+=h,u}return h=w(r/2),q(h-=h%8,n,f,o,u,e,i),q(r-h,n,f,o+h*f,u,e,i),u}function z(r,n,f,t,u){var e,i;return e=f<0?(1-r)*f:0,t[i=u<0?-u:0]=0,t[i+u]=0,q(r,n,f,e,t,u,i),t}function D(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)!1===N(e=n[u])&&(i=t+e,y(t)>=y(e)?o+=t-i+e:o+=e-i+t,t=i),u+=f;return t+o}function H(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:n[t];for(e=t,u=0,a=0,c=0;c<r;c++)!1===N(i=n[e])&&(o=u+i,y(u)>=y(i)?a+=u-o+i:a+=i-o+u,u=o),e+=f;return u+a}function J(r,n,f){return D(r,n,f)}function K(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)!1===N(a=n[e])&&(c=t+a,s=y(t)>=y(a)?t-c+a:a-c+t,t=c,c=i+s,o=y(i)>=y(s)?i-c+s:s-c+i,i=c,u+=o),e+=f;return t+i+u}function L(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return N(n[0])?t:n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)!1===N(n[u])&&(t+=n[u]),u+=f;return t}function Q(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===N(n[u])&&(l+=n[u]),u+=f;return l}if(r<=128){for(e=N(n[u])?0:n[u],i=N(n[u+=f])?0:n[u],o=N(n[u+=f])?0:n[u],a=N(n[u+=f])?0:n[u],c=N(n[u+=f])?0:n[u],s=N(n[u+=f])?0:n[u],v=N(n[u+=f])?0:n[u],d=N(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=N(n[u])?0:n[u],i+=N(n[u+=f])?0:n[u],o+=N(n[u+=f])?0:n[u],a+=N(n[u+=f])?0:n[u],c+=N(n[u+=f])?0:n[u],s+=N(n[u+=f])?0:n[u],v+=N(n[u+=f])?0:n[u],d+=N(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===N(n[u])&&(l+=n[u]),u+=f;return l}return m=w(r/2),Q(m-=m%8,n,f,u)+Q(r-m,n,f,u+m*f)}function R(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===N(n[t])&&(u+=n[t]),t+=f;return u}return Q(r,n,f,t)}function W(r,n,f){var t,u,e,i,o,a;if(r<=0)return n;if(o=w(r/2),1===f){if(e=r-1,(i=o%3)>0)for(u=0;u<i;u++)t=n[u],n[u]=n[e],n[e]=t,e-=1;if(o<3)return n;for(u=i;u<o;u+=3)t=n[u],n[u]=n[e],n[e]=t,t=n[u+1],n[u+1]=n[e-1],n[e-1]=t,t=n[u+2],n[u+2]=n[e-2],n[e-2]=t,e-=3;return n}for(e=(u=f<0?(1-r)*f:0)+(r-1)*f,a=0;a<o;a++)t=n[u],n[u]=n[e],n[e]=t,u+=f,e-=f;return n}function X(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return n+f[u];if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return m}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return m}return p=w(r/2),X(p-=p%8,n,f,t,e)+X(r-p,n,f,t,e+p*t)}function Z(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return e}return X(r,n,f,t,u)}function $(r,n,f,t){return Z(r,n,f,t)}function rr(r,n,f,t,u){var e,i,o,a,c;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return N(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(a=0,c=0;c<r;c++)!1===N(n[i])&&(e+=n[i],a+=1),i+=f;return t[o]=e,t[o+u]=a,t}function nr(r){return r!=r}function fr(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return nr(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===nr(n[u])&&(l+=n[u]),u+=f;return l}if(r<=128){for(e=nr(n[u])?0:n[u],i=nr(n[u+=f])?0:n[u],o=nr(n[u+=f])?0:n[u],a=nr(n[u+=f])?0:n[u],c=nr(n[u+=f])?0:n[u],s=nr(n[u+=f])?0:n[u],v=nr(n[u+=f])?0:n[u],d=nr(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=nr(n[u])?0:n[u],i+=nr(n[u+=f])?0:n[u],o+=nr(n[u+=f])?0:n[u],a+=nr(n[u+=f])?0:n[u],c+=nr(n[u+=f])?0:n[u],s+=nr(n[u+=f])?0:n[u],v+=nr(n[u+=f])?0:n[u],d+=nr(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===nr(n[u])&&(l+=n[u]),u+=f;return l}return m=w(r/2),fr(m-=m%8,n,f,u)+fr(r-m,n,f,u+m*f)}function tr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return nr(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===nr(n[t])&&(u+=n[t]),t+=f;return u}return fr(r,n,f,t)}function ur(r,n,f){return tr(r,n,f)}function er(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return N(n[0])?t:n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)!1===N(n[u])&&(t+=n[u]),u+=f;return t}v(_,"ndarray",h),v(x,"ndarray",k),v(A,"ndarray",j),v(S,"ndarray",(function(r,n,f,t,u,e,i,o){return j(r,n,f,t,u,e,i,o)})),v(F,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,l,m,p,b;if(r<=0)return e;for(c=u,s=o,a=0,v=0,b=0;b<r;b++)m=n+(l=f[c]),p=y(n)>=y(l)?n-m+l:l-m+n,n=m,m=v+p,d=y(v)>=y(p)?v-m+p:p-m+v,v=m,a+=d,e[s]=n+v+a,c+=t,s+=i;return e})),v(T,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s;if(r<=0)return e;for(a=u,c=o,s=0;s<r;s++)n+=f[a],e[c]=n,a+=t,c+=i;return e})),v(O,"ndarray",I),v(E,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return f;if(e=u,1===t){if((i=r%8)>0)for(o=0;o<i;o++)f[e]=n,e+=t;if(r<8)return f;for(o=i;o<r;o+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n,e+=8;return f}for(o=0;o<r;o++)f[e]=n,e+=t;return f})),v(P,"ndarray",U),v(M,"ndarray",(function(r,n,f,t){return U(r,n,f,t)})),v(V,"ndarray",G),v(B,"ndarray",(function(r,n,f,t,u,e,i){return G(r,n,f,t,u,e,i)})),v(Y,"ndarray",(function(r,n,f,t,u,e,i){var o,a,c,s,v,d,l,m,p,b,g;if(v=t,d=i,o=0,r<=0)return u[d]=o,u[d+e]=0,u;if(1===r||0===f)return N(n[v])?(u[d]=o,u[d+e]=0,u):(u[d]=n[v],u[d+e]=1,u);for(a=0,c=0,b=0,g=0;g<r;g++)!1===N(l=n[v])&&(m=o+l,p=y(o)>=y(l)?o-m+l:l-m+o,o=m,m=c+p,s=y(c)>=y(p)?c-m+p:p-m+c,c=m,a+=s,b+=1),v+=f;return u[d]=o+c+a,u[d+e]=b,u})),v(C,"ndarray",(function(r,n,f,t,u,e,i){var o,a,c,s,v;if(a=t,c=i,o=0,r<=0)return u[c]=o,u[c+e]=0,u;if(1===r||0===f)return N(n[a])?(u[c]=o,u[c+e]=0,u):(u[c]=n[a],u[c+e]=1,u);for(s=0,v=0;v<r;v++)!1===N(n[a])&&(o+=n[a],s+=1),a+=f;return u[c]=o,u[c+e]=s,u})),v(z,"ndarray",(function(r,n,f,t,u,e,i){return u[i]=0,u[i+e]=0,q(r,n,f,t,u,e,i),u})),v(D,"ndarray",H),v(J,"ndarray",(function(r,n,f,t){return H(r,n,f,t)})),v(K,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:n[t];for(i=t,u=0,e=0,o=0,d=0;d<r;d++)!1===N(c=n[i])&&(s=u+c,v=y(u)>=y(c)?u-s+c:c-s+u,u=s,s=o+v,a=y(o)>=y(v)?o-s+v:v-s+o,o=s,e+=a),i+=f;return u+o+e})),v(L,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return N(n[t])?u:n[t];for(e=t,i=0;i<r;i++)!1===N(n[e])&&(u+=n[e]),e+=f;return u})),v(R,"ndarray",Q),v(W,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return n;if(a=w(r/2),e=t,1===f){if(i=e+r-1,(o=a%3)>0)for(c=0;c<o;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;if(a<3)return n;for(c=o;c<a;c+=3)u=n[e],n[e]=n[i],n[i]=u,u=n[e+1],n[e+1]=n[i-1],n[i-1]=u,u=n[e+2],n[e+2]=n[i-2],n[i-2]=u,e+=3,i-=3;return n}for(i=e+(r-1)*f,c=0;c<a;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;return n})),v(Z,"ndarray",X),v($,"ndarray",(function(r,n,f,t,u){return X(r,n,f,t,u)})),v(rr,"ndarray",(function(r,n,f,t,u,e,i){var o,a,c,s,v;if(a=t,c=i,o=0,r<=0)return u[c]=o,u[c+e]=0,u;if(1===r||0===f)return N(n[a])?(u[c]=o,u[c+e]=0,u):(u[c]=n[a],u[c+e]=1,u);for(s=0,v=0;v<r;v++)!1===N(n[a])&&(o+=n[a],s+=1),a+=f;return u[c]=o,u[c+e]=s,u})),v(tr,"ndarray",fr),v(ur,"ndarray",(function(r,n,f,t){return fr(r,n,f,t)})),v(er,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return N(n[t])?u:n[t];for(e=t,i=0;i<r;i++)!1===N(n[e])&&(u+=n[e]),e+=f;return u}));var ir=Number.POSITIVE_INFINITY;function or(r){return 0===r&&1/r===ir}function ar(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,p=r,a=w(r/2);;){if(a>0)d=f[i+(a-=1)*t],y=u[o+a*e];else{if(0==(p-=1))return f;d=f[l=i+p*t],y=u[m=o+p*e],f[l]=f[i],u[m]=u[o]}for(c=2*(b=a)+1;c<p&&((g=c+1)<p&&((s=f[i+g*t])>(v=f[i+c*t])||N(s)||s===v&&or(s))&&(c+=1),(s=f[i+c*t])>d||N(s)||s===d&&or(s));)f[i+b*t]=s,u[o+b*e]=u[o+c*e],c=2*(b=c)+1;f[i+b*t]=d,u[o+b*e]=y}}v(ar,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),p=r,a=w(r/2);;){if(a>0)d=f[u+(a-=1)*t],y=e[o+a*i];else{if(0==(p-=1))return f;d=f[l=u+p*t],y=e[m=o+p*i],f[l]=f[u],e[m]=e[o]}for(c=2*(b=a)+1;c<p&&((g=c+1)<p&&((s=f[u+g*t])>(v=f[u+c*t])||N(s)||s===v&&or(s))&&(c+=1),(s=f[u+c*t])>d||N(s)||s===d&&or(s));)f[u+b*t]=s,e[o+b*i]=e[o+c*i],c=2*(b=c)+1;f[u+b*t]=d,e[o+b*i]=y}}));var cr=Number.NEGATIVE_INFINITY;function sr(r){return 0===r&&1/r===cr}function vr(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;if(n<0&&(t*=-1,e*=-1),e<0?(y=(1-r)*e,l=0):(y=0,l=(r-1)*e),v=y+e,t<0){for(s=0,o=(c=(1-r)*t)+t,g=1;g<r;g++)if(m=f[o],p=u[v],N(m)){for(a=o,d=v;a>s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=sr(m),a=o-t,d=v-e;a<=c&&(!((b=f[a])<=m)||i&&b===m&&!1===sr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}for(s=(r-1)*t,o=(c=0)+t,g=1;g<r;g++)if(m=f[o],p=u[v],N(m)){for(a=o,d=v;a<s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=sr(m),a=o-t,d=v-e;a>=c&&(!((b=f[a])<=m)||i&&b===m&&!1===sr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}v(vr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g,w,h;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),d=(v=u)+(r-1)*t,c=v+t,p=(m=o)+(r-1)*i,y=m+i,t<0){for(h=1;h<r;h++)if(b=f[c],g=e[y],N(b)){for(s=c,l=y;s>d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=sr(b),s=c-t,l=y-i;s<=v&&(!((w=f[s])<=b)||a&&w===b&&!1===sr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}for(h=1;h<r;h++)if(b=f[c],g=e[y],N(b)){for(s=c,l=y;s<d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=sr(b),s=c-t,l=y-i;s>=v&&(!((w=f[s])<=b)||a&&w===b&&!1===sr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}));var dr=[701,301,132,57,23,10,4,1],yr=dr.length;function lr(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,y=0;y<yr;y++)for(l=c=dr[y];l<r;l++)if(!N(s=f[i+l*t])){for(v=u[o+l*e],a=sr(s),m=l;m>=c&&(!((d=f[i+(m-c)*t])<=s)||a&&d===s);m-=c)f[i+m*t]=d,u[o+m*e]=u[o+(m-c)*e];f[i+m*t]=s,u[o+m*e]=v}return f}var mr=dr.length;function pr(r,n,f,t){var u,e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=r,e=w(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||N(o)||o===a&&or(o))&&(i+=1),(o=f[u+i*t])>s||N(o)||o===s&&or(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}}function br(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;if(n<0&&(t*=-1),t<0){for(a=0,e=(o=(1-r)*t)+t,v=1;v<r;v++)if(N(c=f[e])){for(i=e;i>a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=sr(c),i=e-t;i<=o&&(!((s=f[i])<=c)||u&&s===c&&!1===sr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}for(a=(r-1)*t,e=(o=0)+t,v=1;v<r;v++)if(N(c=f[e])){for(i=e;i<a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=sr(c),i=e-t;i>=o&&(!((s=f[i])<=c)||u&&s===c&&!1===sr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}v(lr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),y=0;y<mr;y++)for(l=c=dr[y];l<r;l++)if(!N(s=f[u+l*t])){for(v=e[o+l*i],a=sr(s),m=l;m>=c&&(!((d=f[u+(m-c)*t])<=s)||a&&d===s);m-=c)f[u+m*t]=d,e[o+m*i]=e[o+(m-c)*i];f[u+m*t]=s,e[o+m*i]=v}return f})),v(pr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=r,e=w(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||N(o)||o===a&&or(o))&&(i+=1),(o=f[u+i*t])>s||N(o)||o===s&&or(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}})),v(br,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1)),c=(a=u)+(r-1)*t,i=a+t,t<0){for(d=1;d<r;d++)if(N(s=f[i])){for(o=i;o>c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=sr(s),o=i-t;o<=a&&(!((v=f[o])<=s)||e&&v===s&&!1===sr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}for(d=1;d<r;d++)if(N(s=f[i])){for(o=i;o<c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=sr(s),o=i-t;o>=a&&(!((v=f[o])<=s)||e&&v===s&&!1===sr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}));var gr=[701,301,132,57,23,10,4,1],wr=gr.length;function hr(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=0;c<wr;c++)for(s=i=gr[c];s<r;s++)if(!N(o=f[u+s*t])){for(e=sr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f}var _r=gr.length;function kr(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return l}return m=w(r/2),kr(m-=m%8,n,f,u)+kr(r-m,n,f,u+m*f)}function xr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return u}return kr(r,n,f,t)}function Ar(r,n,f){return xr(r,n,f)}function jr(r,n,f){var t,u,e,i;if(t=0,r<=0)return t;if(1===r||0===f)return n[0];if(1===f){if((e=r%6)>0)for(i=0;i<e;i++)t+=n[i];if(r<6)return t;for(i=e;i<r;i+=6)t+=n[i]+n[i+1]+n[i+2]+n[i+3]+n[i+4]+n[i+5];return t}for(u=f<0?(1-r)*f:0,i=0;i<r;i++)t+=n[u],u+=f;return t}function Sr(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)i=t+(e=n[u]),y(t)>=y(e)?o+=t-i+e:o+=e-i+t,t=i,u+=f;return t+o}function Fr(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return n[t];for(e=t,u=0,a=0,c=0;c<r;c++)o=u+(i=n[e]),y(u)>=y(i)?a+=u-o+i:a+=i-o+u,u=o,e+=f;return u+a}function Tr(r,n,f){return Sr(r,n,f)}function Ir(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)c=t+(a=n[e]),s=y(t)>=y(a)?t-c+a:a-c+t,t=c,c=i+s,o=y(i)>=y(s)?i-c+s:s-c+i,i=c,u+=o,e+=f;return t+i+u}function Or(r,n,f){var t,u,e,i;if(t=0,r<=0)return t;if(1===r||0===f)return n[0];if(1===f){if((e=r%6)>0)for(i=0;i<e;i++)t+=n[i];if(r<6)return t;for(i=e;i<r;i+=6)t+=n[i]+n[i+1]+n[i+2]+n[i+3]+n[i+4]+n[i+5];return t}for(u=f<0?(1-r)*f:0,i=0;i<r;i++)t+=n[u],u+=f;return t}function Er(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return l}return m=w(r/2),Er(m-=m%8,n,f,u)+Er(r-m,n,f,u+m*f)}function Nr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return u}return Er(r,n,f,t)}function Pr(r,n,f,t){var u,e,i;if(r<=0||0===n)return f;if(1===t){if((i=r%5)>0)for(e=0;e<i;e++)f[e]+=n;if(r<5)return f;for(e=i;e<r;e+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]+=n,u+=t;return f}function Ur(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,a=0,c=0;c<r;c++)o=u+(i=n+f[e]),y(u)>=y(i)?a+=u-o+i:a+=i-o+u,u=o,e+=t;return u+a}function Mr(r,n,f,t,u){var e,i,o,a,c,s;if(r<=0)return 0;if(1===r||0===t)return n+f[u];for(i=u,e=0,c=0,s=0;s<r;s++)a=e+(o=n+f[i]),y(e)>=y(o)?c+=e-a+o:c+=o-a+e,e=a,i+=t;return e+c}function Vr(r,n,f,t){return Ur(r,n,f,t)}function Gr(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(i=t<0?(1-r)*t:0,u=0,e=0,o=0,d=0;d<r;d++)s=u+(c=n+f[i]),v=y(u)>=y(c)?u-s+c:c-s+u,u=s,s=o+v,a=y(o)>=y(v)?o-s+v:v-s+o,o=s,e+=a,i+=t;return u+o+e}function Br(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(e=t<0?(1-r)*t:0,u=0,i=0;i<r;i++)u+=n+f[e],e+=t;return u}function Yr(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return n+f[u];if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return m}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return m}return p=w(r/2),Yr(p-=p%8,n,f,t,e)+Yr(r-p,n,f,t,e+p*t)}function Cr(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return n+f[0];if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return e}return Yr(r,n,f,t,u)}function qr(r,n,f,t){var u,e,i,o,a,c,s,v,d,l,m,p,b;if(r<=0)return 0;if(1===r||0===f)return y(n[t]);if(u=t,r<8){for(m=0,b=0;b<r;b++)m+=y(n[u]),u+=f;return m}if(r<=128){for(e=y(n[u]),i=y(n[u+f]),o=y(n[u+2*f]),a=y(n[u+3*f]),c=y(n[u+4*f]),s=y(n[u+5*f]),v=y(n[u+6*f]),d=y(n[u+7*f]),u+=8*f,l=r%8,b=8;b<r-l;b+=8)e+=y(n[u]),i+=y(n[u+f]),o+=y(n[u+2*f]),a+=y(n[u+3*f]),c+=y(n[u+4*f]),s+=y(n[u+5*f]),v+=y(n[u+6*f]),d+=y(n[u+7*f]),u+=8*f;for(m=e+i+(o+a)+(c+s+(v+d));b<r;b++)m+=y(n[u]),u+=f;return m}return p=w(r/2),qr(p-=p%8,n,f,u)+qr(r-p,n,f,u+p*f)}function zr(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return y(n[0]);if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=y(n[t]),t+=f;return u}return qr(r,n,f,t)}function Dr(r,n,f,t,u,e){var i,o,a,c,s,v,d;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=n,v=0,d=0;d<r;d++)s=a+(c=f[i]),y(a)>=y(c)?v+=a-s+c:v+=c-s+a,a=s,u[o]=a+v,i+=t,o+=e;return u}function Hr(r,n,f,t,u,e,i,o){var a,c,s,v,d,l,m;if(r<=0)return e;for(a=u,c=o,s=n,l=0,m=0;m<r;m++)d=s+(v=f[a]),y(s)>=y(v)?l+=s-d+v:l+=v-d+s,s=d,e[c]=s+l,a+=t,c+=i;return e}function Jr(r,n,f,t,u,e){return Dr(r,n,f,t,u,e)}function Kr(r,n,f,t,u,e){var i,o,a,c,s,v,d,l,m;if(r<=0)return u;for(o=t<0?(1-r)*t:0,a=e<0?(1-r)*e:0,i=0,c=0,m=0;m<r;m++)d=n+(v=f[o]),l=y(n)>=y(v)?n-d+v:v-d+n,n=d,d=c+l,s=y(c)>=y(l)?c-d+l:l-d+c,c=d,i+=s,u[a]=n+c+i,o+=t,a+=e;return u}function Lr(r,n,f,t,u,e){var i,o,a;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=0;a<r;a++)n+=f[i],u[o]=n,i+=t,o+=e;return u}function Qr(r,n,f,t,u,e,i,o){var a,c,s,v,d;if(r<=0)return e;if(a=u,c=o,r<=128){for(s=0,d=0;d<r;d++)s+=f[a],e[c]=n+s,a+=t,c+=i;return e}return Qr(v=w(r/2),n,f,t,a,e,i,c),Qr(r-v,e[c+=(v-1)*i],f,t,a+v*t,e,i,c+i),e}function Rr(r,n,f,t,u,e){return r<=0?u:Qr(r,n,f,t,t<0?(1-r)*t:0,u,e,e<0?(1-r)*e:0)}function Wr(r,n){return r[n]}function Xr(r,n){return r.get(n)}function Zr(r,n,f){r[n]=f}function $r(r,n,f){r.set(f,n)}function rn(r){var n=Boolean(r.get&&r.set);return{data:r,accessors:n,getter:n?Xr:Wr,setter:n?$r:Zr}}function nn(r,n,f,t,u){var e,i,o,a;for(e=f.data,i=f.setter,o=u,a=0;a<r;a++)i(e,o,n),o+=t;return f}function fn(r,n,f,t){var u,e,i,o;if(r<=0)return f;if((o=rn(f)).accessors)return nn(r,n,o,t,u=t<0?(1-r)*t:0),o.data;if(1===t){if((i=r%8)>0)for(e=0;e<i;e++)f[e]=n;if(r<8)return f;for(e=i;e<r;e+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]=n,u+=t;return f}function tn(r,n,f,t,u,e){var i,o,a,c,s;for(i=n.data,a=n.getter,o=n.setter,c=t,s=0;s<r;s++)o(i,c,u.call(e,a(i,c),s,c,n)),c+=f;return n}function un(r,n,f,t,u){var e,i,o;if(r<=0)return n;if(e=f<0?(1-r)*f:0,(i=rn(n)).accessors)return tn(r,i,f,e,t,u),i.data;for(o=0;o<r;o++)n[e]=t.call(u,n[e],o,e,n),e+=f;return n}function en(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)!1===N(e=n[u])&&(i=t+e,y(t)>=y(e)?o+=t-i+e:o+=e-i+t,t=i),u+=f;return t+o}function on(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:n[t];for(e=t,u=0,a=0,c=0;c<r;c++)!1===N(i=n[e])&&(o=u+i,y(u)>=y(i)?a+=u-o+i:a+=i-o+u,u=o),e+=f;return u+a}function an(r,n,f){return en(r,n,f)}function cn(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)!1===N(a=n[e])&&(c=t+a,s=y(t)>=y(a)?t-c+a:a-c+t,t=c,c=i+s,o=y(i)>=y(s)?i-c+s:s-c+i,i=c,u+=o),e+=f;return t+i+u}function sn(r,n,f){var t,u,e;if(u=0,r<=0)return u;if(1===r||0===f)return N(n[0])?u:n[0];for(t=f<0?(1-r)*f:0,e=0;e<r;e++)!1===N(n[t])&&(u+=n[t]),t+=f;return u}function vn(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===N(n[u])&&(l+=n[u]),u+=f;return l}if(r<=128){for(e=N(n[u])?0:n[u],i=N(n[u+=f])?0:n[u],o=N(n[u+=f])?0:n[u],a=N(n[u+=f])?0:n[u],c=N(n[u+=f])?0:n[u],s=N(n[u+=f])?0:n[u],v=N(n[u+=f])?0:n[u],d=N(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=N(n[u])?0:n[u],i+=N(n[u+=f])?0:n[u],o+=N(n[u+=f])?0:n[u],a+=N(n[u+=f])?0:n[u],c+=N(n[u+=f])?0:n[u],s+=N(n[u+=f])?0:n[u],v+=N(n[u+=f])?0:n[u],d+=N(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===N(n[u])&&(l+=n[u]),u+=f;return l}return m=w(r/2),vn(m-=m%8,n,f,u)+vn(r-m,n,f,u+m*f)}function dn(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return N(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===N(n[t])&&(u+=n[t]),t+=f;return u}return vn(r,n,f,t)}function yn(r,n,f,t){var u,e,i,o,a,c,s,v;for(u=n.data,e=n.setter,i=n.getter,s=w(r/2),c=(a=t)+(r-1)*f,v=0;v<s;v++)o=i(u,a),e(u,a,i(u,c)),e(u,c,o),a+=f,c-=f;return n}function ln(r,n,f){var t,u,e,i,o,a,c;if(r<=0)return n;if((i=rn(n)).accessors)return yn(r,i,f,u=f<0?(1-r)*f:0),i.data;if(a=w(r/2),1===f){if(e=r-1,(o=a%3)>0)for(u=0;u<o;u++)t=n[u],n[u]=n[e],n[e]=t,e-=1;if(a<3)return n;for(u=o;u<a;u+=3)t=n[u],n[u]=n[e],n[e]=t,t=n[u+1],n[u+1]=n[e-1],n[e-1]=t,t=n[u+2],n[u+2]=n[e-2],n[e-2]=t,e-=3;return n}for(e=(u=f<0?(1-r)*f:0)+(r-1)*f,c=0;c<a;c++)t=n[u],n[u]=n[e],n[e]=t,u+=f,e-=f;return n}function mn(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,p=r,a=w(r/2);;){if(a>0)d=f[i+(a-=1)*t],y=u[o+a*e];else{if(0==(p-=1))return f;d=f[l=i+p*t],y=u[m=o+p*e],f[l]=f[i],u[m]=u[o]}for(c=2*(b=a)+1;c<p&&((g=c+1)<p&&((s=f[i+g*t])>(v=f[i+c*t])||N(s)||s===v&&or(s))&&(c+=1),(s=f[i+c*t])>d||N(s)||s===d&&or(s));)f[i+b*t]=s,u[o+b*e]=u[o+c*e],c=2*(b=c)+1;f[i+b*t]=d,u[o+b*e]=y}}function pn(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;if(n<0&&(t*=-1,e*=-1),e<0?(y=(1-r)*e,l=0):(y=0,l=(r-1)*e),v=y+e,t<0){for(s=0,o=(c=(1-r)*t)+t,g=1;g<r;g++)if(m=f[o],p=u[v],N(m)){for(a=o,d=v;a>s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=sr(m),a=o-t,d=v-e;a<=c&&(!((b=f[a])<=m)||i&&b===m&&!1===sr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}for(s=(r-1)*t,o=(c=0)+t,g=1;g<r;g++)if(m=f[o],p=u[v],N(m)){for(a=o,d=v;a<s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=sr(m),a=o-t,d=v-e;a>=c&&(!((b=f[a])<=m)||i&&b===m&&!1===sr(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}v(hr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=0;c<_r;c++)for(s=i=gr[c];s<r;s++)if(!N(o=f[u+s*t])){for(e=sr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f})),v(xr,"ndarray",kr),v(Ar,"ndarray",(function(r,n,f,t){return kr(r,n,f,t)})),v(jr,"ndarray",(function(r,n,f,t){var u,e,i,o;if(u=0,r<=0)return u;if(1===r||0===f)return n[t];if(e=t,1===f){if((i=r%6)>0)for(o=0;o<i;o++)u+=n[e],e+=f;if(r<6)return u;for(o=i;o<r;o+=6)u+=n[e]+n[e+1]+n[e+2]+n[e+3]+n[e+4]+n[e+5],e+=6;return u}for(o=0;o<r;o++)u+=n[e],e+=f;return u})),v(Sr,"ndarray",Fr),v(Tr,"ndarray",(function(r,n,f,t){return Fr(r,n,f,t)})),v(Ir,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===f)return n[t];for(i=t,u=0,e=0,o=0,d=0;d<r;d++)s=u+(c=n[i]),v=y(u)>=y(c)?u-s+c:c-s+u,u=s,s=o+v,a=y(o)>=y(v)?o-s+v:v-s+o,o=s,e+=a,i+=f;return u+o+e})),v(Or,"ndarray",(function(r,n,f,t){var u,e,i,o;if(u=0,r<=0)return u;if(1===r||0===f)return n[t];if(e=t,1===f){if((i=r%6)>0)for(o=0;o<i;o++)u+=n[e],e+=f;if(r<6)return u;for(o=i;o<r;o+=6)u+=n[e]+n[e+1]+n[e+2]+n[e+3]+n[e+4]+n[e+5],e+=6;return u}for(o=0;o<r;o++)u+=n[e],e+=f;return u})),v(Nr,"ndarray",Er),v(Pr,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0||0===n)return f;if(e=u,1===t){if((i=r%5)>0)for(o=0;o<i;o++)f[e]+=n,e+=t;if(r<5)return f;for(o=i;o<r;o+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n,e+=5;return f}for(o=0;o<r;o++)f[e]+=n,e+=t;return f})),v(Ur,"ndarray",Mr),v(Vr,"ndarray",(function(r,n,f,t,u){return Mr(r,n,f,t,u)})),v(Gr,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,l;if(r<=0)return 0;if(1===r||0===t)return n+f[0];for(o=u,e=0,i=0,a=0,l=0;l<r;l++)v=e+(s=n+f[o]),d=y(e)>=y(s)?e-v+s:s-v+e,e=v,v=a+d,c=y(a)>=y(d)?a-v+d:d-v+a,a=v,i+=c,o+=t;return e+a+i})),v(Br,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return 0;if(1===r||0===t)return n+f[u];for(i=u,e=0,o=0;o<r;o++)e+=n+f[i],i+=t;return e})),v(Cr,"ndarray",Yr),v(zr,"ndarray",qr),v(Dr,"ndarray",Hr),v(Jr,"ndarray",(function(r,n,f,t,u,e,i,o){return Hr(r,n,f,t,u,e,i,o)})),v(Kr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,l,m,p,b;if(r<=0)return e;for(c=u,s=o,a=0,v=0,b=0;b<r;b++)m=n+(l=f[c]),p=y(n)>=y(l)?n-m+l:l-m+n,n=m,m=v+p,d=y(v)>=y(p)?v-m+p:p-m+v,v=m,a+=d,e[s]=n+v+a,c+=t,s+=i;return e})),v(Lr,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s;if(r<=0)return e;for(a=u,c=o,s=0;s<r;s++)n+=f[a],e[c]=n,a+=t,c+=i;return e})),v(Rr,"ndarray",Qr),v(fn,"ndarray",(function(r,n,f,t,u){var e,i,o,a;if(r<=0)return f;if((o=rn(f)).accessors)return nn(r,n,o,t,u),o.data;if(e=u,1===t){if((i=r%8)>0)for(a=0;a<i;a++)f[e]=n,e+=t;if(r<8)return f;for(a=i;a<r;a+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n,e+=8;return f}for(a=0;a<r;a++)f[e]=n,e+=t;return f})),v(un,"ndarray",(function(r,n,f,t,u,e){var i,o,a;if(r<=0)return n;if((o=rn(n)).accessors)return tn(r,o,f,t,u,e),o.data;for(i=t,a=0;a<r;a++)n[i]=u.call(e,n[i],a,i,n),i+=f;return n})),v(en,"ndarray",on),v(an,"ndarray",(function(r,n,f,t){return on(r,n,f,t)})),v(cn,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===f)return N(n[t])?0:n[t];for(i=t,u=0,e=0,o=0,d=0;d<r;d++)!1===N(c=n[i])&&(s=u+c,v=y(u)>=y(c)?u-s+c:c-s+u,u=s,s=o+v,a=y(o)>=y(v)?o-s+v:v-s+o,o=s,e+=a),i+=f;return u+o+e})),v(sn,"ndarray",(function(r,n,f,t){var u,e,i;if(e=0,r<=0)return e;if(1===r||0===f)return N(n[t])?e:n[t];for(u=t,i=0;i<r;i++)!1===N(n[u])&&(e+=n[u]),u+=f;return e})),v(dn,"ndarray",vn),v(ln,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s;if(r<=0)return n;if((o=rn(n)).accessors)return yn(r,o,f,t),o.data;if(c=w(r/2),e=t,1===f){if(i=e+r-1,(a=c%3)>0)for(s=0;s<a;s++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;if(c<3)return n;for(s=a;s<c;s+=3)u=n[e],n[e]=n[i],n[i]=u,u=n[e+1],n[e+1]=n[i-1],n[i-1]=u,u=n[e+2],n[e+2]=n[i-2],n[i-2]=u,e+=3,i-=3;return n}for(i=e+(r-1)*f,s=0;s<c;s++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;return n})),v(mn,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),p=r,a=w(r/2);;){if(a>0)d=f[u+(a-=1)*t],y=e[o+a*i];else{if(0==(p-=1))return f;d=f[l=u+p*t],y=e[m=o+p*i],f[l]=f[u],e[m]=e[o]}for(c=2*(b=a)+1;c<p&&((g=c+1)<p&&((s=f[u+g*t])>(v=f[u+c*t])||N(s)||s===v&&or(s))&&(c+=1),(s=f[u+c*t])>d||N(s)||s===d&&or(s));)f[u+b*t]=s,e[o+b*i]=e[o+c*i],c=2*(b=c)+1;f[u+b*t]=d,e[o+b*i]=y}})),v(pn,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g,w,h;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),d=(v=u)+(r-1)*t,c=v+t,p=(m=o)+(r-1)*i,y=m+i,t<0){for(h=1;h<r;h++)if(b=f[c],g=e[y],N(b)){for(s=c,l=y;s>d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=sr(b),s=c-t,l=y-i;s<=v&&(!((w=f[s])<=b)||a&&w===b&&!1===sr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}for(h=1;h<r;h++)if(b=f[c],g=e[y],N(b)){for(s=c,l=y;s<d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=sr(b),s=c-t,l=y-i;s>=v&&(!((w=f[s])<=b)||a&&w===b&&!1===sr(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}));var bn=[701,301,132,57,23,10,4,1],gn=bn.length;function wn(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,y=0;y<gn;y++)for(l=c=bn[y];l<r;l++)if(!N(s=f[i+l*t])){for(v=u[o+l*e],a=sr(s),m=l;m>=c&&(!((d=f[i+(m-c)*t])<=s)||a&&d===s);m-=c)f[i+m*t]=d,u[o+m*e]=u[o+(m-c)*e];f[i+m*t]=s,u[o+m*e]=v}return f}var hn=bn.length;function _n(r,n,f,t){var u,e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=r,e=w(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||N(o)||o===a&&or(o))&&(i+=1),(o=f[u+i*t])>s||N(o)||o===s&&or(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}}function kn(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;if(n<0&&(t*=-1),t<0){for(a=0,e=(o=(1-r)*t)+t,v=1;v<r;v++)if(N(c=f[e])){for(i=e;i>a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=sr(c),i=e-t;i<=o&&(!((s=f[i])<=c)||u&&s===c&&!1===sr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}for(a=(r-1)*t,e=(o=0)+t,v=1;v<r;v++)if(N(c=f[e])){for(i=e;i<a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=sr(c),i=e-t;i>=o&&(!((s=f[i])<=c)||u&&s===c&&!1===sr(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}v(wn,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),y=0;y<hn;y++)for(l=c=bn[y];l<r;l++)if(!N(s=f[u+l*t])){for(v=e[o+l*i],a=sr(s),m=l;m>=c&&(!((d=f[u+(m-c)*t])<=s)||a&&d===s);m-=c)f[u+m*t]=d,e[o+m*i]=e[o+(m-c)*i];f[u+m*t]=s,e[o+m*i]=v}return f})),v(_n,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=r,e=w(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||N(o)||o===a&&or(o))&&(i+=1),(o=f[u+i*t])>s||N(o)||o===s&&or(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}})),v(kn,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1)),c=(a=u)+(r-1)*t,i=a+t,t<0){for(d=1;d<r;d++)if(N(s=f[i])){for(o=i;o>c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=sr(s),o=i-t;o<=a&&(!((v=f[o])<=s)||e&&v===s&&!1===sr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}for(d=1;d<r;d++)if(N(s=f[i])){for(o=i;o<c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=sr(s),o=i-t;o>=a&&(!((v=f[o])<=s)||e&&v===s&&!1===sr(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}));var xn=[701,301,132,57,23,10,4,1],An=xn.length;function jn(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=0;c<An;c++)for(s=i=xn[c];s<r;s++)if(!N(o=f[u+s*t])){for(e=sr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f}var Sn=xn.length;function Fn(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)i=t+(e=n[u]),y(t)>=y(e)?o+=t-i+e:o+=e-i+t,t=i,u+=f;return t+o}function Tn(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return n[t];for(e=t,u=0,a=0,c=0;c<r;c++)o=u+(i=n[e]),y(u)>=y(i)?a+=u-o+i:a+=i-o+u,u=o,e+=f;return u+a}function In(r,n,f){return Fn(r,n,f)}function On(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)c=t+(a=n[e]),s=y(t)>=y(a)?t-c+a:a-c+t,t=c,c=i+s,o=y(i)>=y(s)?i-c+s:s-c+i,i=c,u+=o,e+=f;return t+i+u}function En(r,n,f){var t,u,e,i;if(e=0,r<=0)return e;if(1===r||0===f)return n[0];if(1===f){if((u=r%6)>0)for(i=0;i<u;i++)e+=n[i];if(r<6)return e;for(i=u;i<r;i+=6)e+=n[i]+n[i+1]+n[i+2]+n[i+3]+n[i+4]+n[i+5];return e}for(t=f<0?(1-r)*f:0,i=0;i<r;i++)e+=n[t],t+=f;return e}function Nn(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return l}return m=w(r/2),Nn(m-=m%8,n,f,u)+Nn(r-m,n,f,u+m*f)}function Pn(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return u}return Nn(r,n,f,t)}function Un(r,n,f,t){var u,e,i;if(r<=0||0===n)return f;if(1===t){if((i=r%5)>0)for(e=0;e<i;e++)f[e]+=n;if(r<5)return f;for(e=i;e<r;e+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]+=n,u+=t;return f}v(jn,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=0;c<Sn;c++)for(s=i=xn[c];s<r;s++)if(!N(o=f[u+s*t])){for(e=sr(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f})),v(Fn,"ndarray",Tn),v(In,"ndarray",(function(r,n,f,t){return Tn(r,n,f,t)})),v(On,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===f)return n[t];for(i=t,u=0,e=0,o=0,d=0;d<r;d++)s=u+(c=n[i]),v=y(u)>=y(c)?u-s+c:c-s+u,u=s,s=o+v,a=y(o)>=y(v)?o-s+v:v-s+o,o=s,e+=a,i+=f;return u+o+e})),v(En,"ndarray",(function(r,n,f,t){var u,e,i,o;if(i=0,r<=0)return i;if(1===r||0===f)return n[t];if(u=t,1===f){if((e=r%6)>0)for(o=0;o<e;o++)i+=n[u],u+=f;if(r<6)return i;for(o=e;o<r;o+=6)i+=n[u]+n[u+1]+n[u+2]+n[u+3]+n[u+4]+n[u+5],u+=6;return i}for(o=0;o<r;o++)i+=n[u],u+=f;return i})),v(Pn,"ndarray",Nn),v(Un,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0||0===n)return f;if(e=u,1===t){if((i=r%5)>0)for(o=0;o<i;o++)f[e]+=n,e+=t;if(r<5)return f;for(o=i;o<r;o+=5)f[e]+=n,f[e+1]+=n,f[e+2]+=n,f[e+3]+=n,f[e+4]+=n,e+=5;return f}for(o=0;o<r;o++)f[e]+=n,e+=t;return f}));var Mn,Vn="function"==typeof Math.fround?Math.fround:null,Gn="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),Bn=Object.prototype.toString,Yn=Object.prototype.hasOwnProperty,Cn="function"==typeof Symbol?Symbol.toStringTag:"";Mn=Gn&&"symbol"==typeof Symbol.toStringTag?function(r){var n,f,t,u,e;if(null==r)return Bn.call(r);f=r[Cn],e=Cn,n=null!=(u=r)&&Yn.call(u,e);try{r[Cn]=void 0}catch(n){return Bn.call(r)}return t=Bn.call(r),n?r[Cn]=f:delete r[Cn],t}:function(r){return Bn.call(r)};var qn=Mn,zn="function"==typeof Float32Array,Dn="function"==typeof Float32Array?Float32Array:null,Hn="function"==typeof Float32Array?Float32Array:void 0,Jn=function(){var r,n,f;if("function"!=typeof Dn)return!1;try{n=new Dn([1,3.14,-3.14,5e40]),f=n,r=(zn&&f instanceof Float32Array||"[object Float32Array]"===qn(f))&&1===n[0]&&3.140000104904175===n[1]&&-3.140000104904175===n[2]&&n[3]===ir}catch(n){r=!1}return r}()?Hn:function(){throw new Error("not implemented")},Kn=new Jn(1),Ln="function"==typeof Vn?Vn:function(r){return Kn[0]=r,Kn[0]};function Qn(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[0]);for(e=t<0?(1-r)*t:0,u=0,a=0,c=0;c<r;c++)i=Ln(n+f[e]),o=Ln(u+i),a=y(u)>=y(i)?Ln(a+Ln(Ln(u-o)+i)):Ln(a+Ln(Ln(i-o)+u)),u=o,e+=t;return Ln(u+a)}function Rn(r,n,f,t,u){var e,i,o,a,c,s;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[u]);for(i=u,e=0,c=0,s=0;s<r;s++)o=Ln(n+f[i]),a=Ln(e+o),c=y(e)>=y(o)?Ln(c+Ln(Ln(e-a)+o)):Ln(c+Ln(Ln(o-a)+e)),e=a,i+=t;return Ln(e+c)}function Wn(r,n,f,t){return Qn(r,n,f,t)}function Xn(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[0]);for(i=t<0?(1-r)*t:0,u=0,e=0,o=0,d=0;d<r;d++)c=Ln(n+f[i]),s=Ln(u+c),v=y(u)>=y(c)?Ln(Ln(u-s)+c):Ln(Ln(c-s)+u),u=s,s=Ln(o+v),a=y(o)>=y(v)?Ln(Ln(o-s)+v):Ln(Ln(v-s)+o),o=s,e=Ln(e+a),i+=t;return Ln(u+Ln(o+e))}function Zn(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[0]);for(e=t<0?(1-r)*t:0,u=0,i=0;i<r;i++)u=Ln(u+Ln(n+f[e])),e+=t;return u}function $n(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[u]);if(e=u,r<8){for(m=0,b=0;b<r;b++)m=Ln(m+Ln(n+f[e])),e+=t;return m}if(r<=128){for(i=Ln(n+f[e]),o=Ln(n+f[e+t]),a=Ln(n+f[e+2*t]),c=Ln(n+f[e+3*t]),s=Ln(n+f[e+4*t]),v=Ln(n+f[e+5*t]),d=Ln(n+f[e+6*t]),y=Ln(n+f[e+7*t]),e+=8*t,l=r%8,b=8;b<r-l;b+=8)i=Ln(i+Ln(n+f[e])),o=Ln(o+Ln(n+f[e+t])),a=Ln(a+Ln(n+f[e+2*t])),c=Ln(c+Ln(n+f[e+3*t])),s=Ln(s+Ln(n+f[e+4*t])),v=Ln(v+Ln(n+f[e+5*t])),d=Ln(d+Ln(n+f[e+6*t])),y=Ln(y+Ln(n+f[e+7*t])),e+=8*t;for(m=Ln(Ln(Ln(i+o)+Ln(a+c))+Ln(Ln(s+v)+Ln(d+y)));b<r;b++)m=Ln(m+Ln(n+f[e])),e+=t;return m}return p=w(r/2),Ln($n(p-=p%8,n,f,t,e)+$n(r-p,n,f,t,e+p*t))}function rf(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[0]);if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e=Ln(e+Ln(n+f[u])),u+=t;return e}return $n(r,n,f,t,u)}function nf(r,n,f,t){var u,e,i,o,a,c,s,v,d,l,m,p,b;if(r<=0)return 0;if(1===r||0===f)return y(n[t]);if(u=t,r<8){for(m=0,b=0;b<r;b++)m=Ln(m+y(n[u])),u+=f;return m}if(r<=128){for(e=y(n[u]),i=y(n[u+f]),o=y(n[u+2*f]),a=y(n[u+3*f]),c=y(n[u+4*f]),s=y(n[u+5*f]),v=y(n[u+6*f]),d=y(n[u+7*f]),u+=8*f,l=r%8,b=8;b<r-l;b+=8)e=Ln(e+y(n[u])),i=Ln(i+y(n[u+f])),o=Ln(o+y(n[u+2*f])),a=Ln(a+y(n[u+3*f])),c=Ln(c+y(n[u+4*f])),s=Ln(s+y(n[u+5*f])),v=Ln(v+y(n[u+6*f])),d=Ln(d+y(n[u+7*f])),u+=8*f;for(m=Ln(Ln(Ln(e+i)+Ln(o+a))+Ln(Ln(c+s)+Ln(v+d)));b<r;b++)m=Ln(m+y(n[u])),u+=f;return m}return p=w(r/2),Ln(nf(p-=p%8,n,f,u)+nf(r-p,n,f,u+p*f))}function ff(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return y(n[0]);if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u=Ln(u+y(n[t])),t+=f;return u}return nf(r,n,f,t)}function tf(r,n,f,t,u,e){var i,o,a,c,s,v,d;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=n,v=0,d=0;d<r;d++)c=f[i],s=Ln(a+c),v=y(a)>=y(c)?Ln(v+Ln(Ln(a-s)+c)):Ln(v+Ln(Ln(c-s)+a)),a=s,u[o]=Ln(a+v),i+=t,o+=e;return u}function uf(r,n,f,t,u,e,i,o){var a,c,s,v,d,l,m;if(r<=0)return e;for(a=u,c=o,s=n,l=0,m=0;m<r;m++)v=f[a],d=Ln(s+v),l=y(s)>=y(v)?Ln(l+Ln(Ln(s-d)+v)):Ln(l+Ln(Ln(v-d)+s)),s=d,e[c]=Ln(s+l),a+=t,c+=i;return e}function ef(r,n,f,t,u,e){return tf(r,n,f,t,u,e)}function of(r,n,f,t,u,e){var i,o,a,c,s,v,d,l,m;if(r<=0)return u;for(o=t<0?(1-r)*t:0,a=e<0?(1-r)*e:0,i=0,c=0,m=0;m<r;m++)v=f[o],d=Ln(n+v),l=y(n)>=y(v)?Ln(Ln(n-d)+v):Ln(Ln(v-d)+n),n=d,d=Ln(c+l),s=y(c)>=y(l)?Ln(Ln(c-d)+l):Ln(Ln(l-d)+c),c=d,i=Ln(i+s),u[a]=Ln(n+Ln(c+i)),o+=t,a+=e;return u}function af(r,n,f,t,u,e){var i,o,a;if(r<=0)return u;for(i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,a=0;a<r;a++)n=Ln(n+f[i]),u[o]=n,i+=t,o+=e;return u}function cf(r,n,f,t,u,e,i,o){var a,c,s,v,d;if(r<=0)return e;if(a=u,c=o,r<=128){for(s=0,d=0;d<r;d++)s=Ln(s+f[a]),e[c]=Ln(n+s),a+=t,c+=i;return e}return cf(v=w(r/2),n,f,t,a,e,i,c),cf(r-v,e[c+=(v-1)*i],f,t,a+v*t,e,i,c+i),e}function sf(r,n,f,t,u,e){return r<=0?u:cf(r,n,f,t,t<0?(1-r)*t:0,u,e,e<0?(1-r)*e:0)}function vf(r,n,f,t,u){var e,i,o,a,c,s,v,d,y,l,m,p,b;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[u]);if(e=u,r<8){for(m=0,b=0;b<r;b++)m+=n+f[e],e+=t;return Ln(m)}if(r<=128){for(i=n+f[e],o=n+f[e+t],a=n+f[e+2*t],c=n+f[e+3*t],s=n+f[e+4*t],v=n+f[e+5*t],d=n+f[e+6*t],y=n+f[e+7*t],e+=8*t,l=r%8,b=8;b<r-l;b+=8)i+=n+f[e],o+=n+f[e+t],a+=n+f[e+2*t],c+=n+f[e+3*t],s+=n+f[e+4*t],v+=n+f[e+5*t],d+=n+f[e+6*t],y+=n+f[e+7*t],e+=8*t;for(m=i+o+(a+c)+(s+v+(d+y));b<r;b++)m+=n+f[e],e+=t;return Ln(m)}return p=w(r/2),Ln(vf(p-=p%8,n,f,t,e)+vf(r-p,n,f,t,e+p*t))}function df(r,n,f,t){var u,e,i;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[0]);if(u=t<0?(1-r)*t:0,r<8){for(e=0,i=0;i<r;i++)e+=n+f[u],u+=t;return Ln(e)}return vf(r,n,f,t,u)}function yf(r,n,f,t){return df(r,n,f,t)}function lf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return nr(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===nr(n[u])&&(l+=n[u]),u+=f;return Ln(l)}if(r<=128){for(e=nr(n[u])?0:n[u],i=nr(n[u+=f])?0:n[u],o=nr(n[u+=f])?0:n[u],a=nr(n[u+=f])?0:n[u],c=nr(n[u+=f])?0:n[u],s=nr(n[u+=f])?0:n[u],v=nr(n[u+=f])?0:n[u],d=nr(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e+=nr(n[u])?0:n[u],i+=nr(n[u+=f])?0:n[u],o+=nr(n[u+=f])?0:n[u],a+=nr(n[u+=f])?0:n[u],c+=nr(n[u+=f])?0:n[u],s+=nr(n[u+=f])?0:n[u],v+=nr(n[u+=f])?0:n[u],d+=nr(n[u+=f])?0:n[u],u+=f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)!1===nr(n[u])&&(l+=n[u]),u+=f;return Ln(l)}return m=w(r/2),Ln(lf(m-=m%8,n,f,u)+lf(r-m,n,f,u+m*f))}function mf(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return nr(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===nr(n[t])&&(u+=n[t]),t+=f;return Ln(u)}return lf(r,n,f,t)}function pf(r,n,f){return mf(r,n,f)}function bf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l+=n[u],u+=f;return Ln(l)}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e+=n[u],i+=n[u+f],o+=n[u+2*f],a+=n[u+3*f],c+=n[u+4*f],s+=n[u+5*f],v+=n[u+6*f],d+=n[u+7*f],u+=8*f;for(l=e+i+(o+a)+(c+s+(v+d));p<r;p++)l+=n[u],u+=f;return Ln(l)}return m=w(r/2),Ln(bf(m-=m%8,n,f,u)+bf(r-m,n,f,u+m*f))}function gf(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u+=n[t],t+=f;return Ln(u)}return bf(r,n,f,t)}function wf(r,n,f){return gf(r,n,f)}function hf(r,n,f,t){var u,e,i;if(r<=0)return f;if(1===t){if((i=r%8)>0)for(e=0;e<i;e++)f[e]=n;if(r<8)return f;for(e=i;e<r;e+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n;return f}for(u=t<0?(1-r)*t:0,e=0;e<r;e++)f[u]=n,u+=t;return f}function _f(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return nr(n[0])?0:n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)!1===nr(e=n[u])&&(i=t+e,o=y(t)>=y(e)?Ln(o+Ln(Ln(t-i)+e)):Ln(o+Ln(Ln(e-i)+t)),t=i),u+=f;return Ln(t+o)}function kf(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return nr(n[t])?0:n[t];for(e=t,u=0,a=0,c=0;c<r;c++)!1===nr(i=n[e])&&(o=u+i,a=y(u)>=y(i)?Ln(a+Ln(Ln(u-o)+i)):Ln(a+Ln(Ln(i-o)+u)),u=o),e+=f;return Ln(u+a)}function xf(r,n,f){return _f(r,n,f)}function Af(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return nr(n[0])?0:n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)!1===nr(a=n[e])&&(c=Ln(t+a),s=y(t)>=y(a)?Ln(Ln(t-c)+a):Ln(Ln(a-c)+t),t=c,c=Ln(i+s),o=y(i)>=y(s)?Ln(Ln(i-c)+s):Ln(Ln(s-c)+i),i=c,u=Ln(u+o)),e+=f;return Ln(t+Ln(i+u))}function jf(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return nr(n[0])?t:n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)!1===nr(n[u])&&(t=Ln(t+n[u])),u+=f;return t}function Sf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return nr(n[t])?0:n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)!1===nr(n[u])&&(l=Ln(l+n[u])),u+=f;return l}if(r<=128){for(e=nr(n[u])?0:n[u],i=nr(n[u+=f])?0:n[u],o=nr(n[u+=f])?0:n[u],a=nr(n[u+=f])?0:n[u],c=nr(n[u+=f])?0:n[u],s=nr(n[u+=f])?0:n[u],v=nr(n[u+=f])?0:n[u],d=nr(n[u+=f])?0:n[u],u+=f,y=r%8,p=8;p<r-y;p+=8)e=nr(n[u])?e:Ln(e+n[u]),i=nr(n[u+=f])?i:Ln(i+n[u]),o=nr(n[u+=f])?o:Ln(o+n[u]),a=nr(n[u+=f])?a:Ln(a+n[u]),c=nr(n[u+=f])?c:Ln(c+n[u]),s=nr(n[u+=f])?s:Ln(s+n[u]),v=nr(n[u+=f])?v:Ln(v+n[u]),d=nr(n[u+=f])?d:Ln(d+n[u]),u+=f;for(l=Ln(Ln(Ln(e+i)+Ln(o+a))+Ln(Ln(c+s)+Ln(v+d)));p<r;p++)!1===nr(n[u])&&(l=Ln(l+n[u])),u+=f;return l}return m=w(r/2),Ln(Sf(m-=m%8,n,f,u)+Sf(r-m,n,f,u+m*f))}function Ff(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return nr(n[0])?0:n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)!1===nr(n[t])&&(u=Ln(u+n[t])),t+=f;return u}return Sf(r,n,f,t)}function Tf(r,n,f){var t,u,e,i,o,a;if(r<=0)return n;if(o=w(r/2),1===f){if(e=r-1,(i=o%3)>0)for(u=0;u<i;u++)t=n[u],n[u]=n[e],n[e]=t,e-=1;if(o<3)return n;for(u=i;u<o;u+=3)t=n[u],n[u]=n[e],n[e]=t,t=n[u+1],n[u+1]=n[e-1],n[e-1]=t,t=n[u+2],n[u+2]=n[e-2],n[e-2]=t,e-=3;return n}for(e=(u=f<0?(1-r)*f:0)+(r-1)*f,a=0;a<o;a++)t=n[u],n[u]=n[e],n[e]=t,u+=f,e-=f;return n}v(Qn,"ndarray",Rn),v(Wn,"ndarray",(function(r,n,f,t,u){return Rn(r,n,f,t,u)})),v(Xn,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,l;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[u]);for(o=u,e=0,i=0,a=0,l=0;l<r;l++)s=Ln(n+f[o]),v=Ln(e+s),d=y(e)>=y(s)?Ln(Ln(e-v)+s):Ln(Ln(s-v)+e),e=v,v=Ln(a+d),c=y(a)>=y(d)?Ln(Ln(a-v)+d):Ln(Ln(d-v)+a),a=v,i=Ln(i+c),o+=t;return Ln(e+Ln(a+i))})),v(Zn,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return 0;if(1===r||0===t)return Ln(n+f[0]);for(i=u,e=0,o=0;o<r;o++)e=Ln(e+Ln(n+f[i])),i+=t;return e})),v(rf,"ndarray",$n),v(ff,"ndarray",nf),v(tf,"ndarray",uf),v(ef,"ndarray",(function(r,n,f,t,u,e,i,o){return uf(r,n,f,t,u,e,i,o)})),v(of,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,l,m,p,b;if(r<=0)return e;for(c=u,s=o,a=0,v=0,b=0;b<r;b++)l=f[c],m=Ln(n+l),p=y(n)>=y(l)?Ln(Ln(n-m)+l):Ln(Ln(l-m)+n),n=m,m=Ln(v+p),d=y(v)>=y(p)?Ln(Ln(v-m)+p):Ln(Ln(p-m)+v),v=m,a=Ln(a+d),e[s]=Ln(n+Ln(v+a)),c+=t,s+=i;return e})),v(af,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s;if(r<=0)return e;for(a=u,c=o,s=0;s<r;s++)n=Ln(n+f[a]),e[c]=n,a+=t,c+=i;return e})),v(sf,"ndarray",cf),v(df,"ndarray",vf),v(yf,"ndarray",(function(r,n,f,t,u){return vf(r,n,f,t,u)})),v(mf,"ndarray",lf),v(pf,"ndarray",(function(r,n,f,t){return lf(r,n,f,t)})),v(gf,"ndarray",bf),v(wf,"ndarray",(function(r,n,f,t){return bf(r,n,f,t)})),v(hf,"ndarray",(function(r,n,f,t,u){var e,i,o;if(r<=0)return f;if(e=u,1===t){if((i=r%8)>0)for(o=0;o<i;o++)f[e]=n,e+=t;if(r<8)return f;for(o=i;o<r;o+=8)f[e]=n,f[e+1]=n,f[e+2]=n,f[e+3]=n,f[e+4]=n,f[e+5]=n,f[e+6]=n,f[e+7]=n,e+=8;return f}for(o=0;o<r;o++)f[e]=n,e+=t;return f})),v(_f,"ndarray",kf),v(xf,"ndarray",(function(r,n,f,t){return kf(r,n,f,t)})),v(Af,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===f)return nr(n[t])?0:n[t];for(i=t,u=0,e=0,o=0,d=0;d<r;d++)!1===nr(c=n[i])&&(s=Ln(u+c),v=y(u)>=y(c)?Ln(Ln(u-s)+c):Ln(Ln(c-s)+u),u=s,s=Ln(o+v),a=y(o)>=y(v)?Ln(Ln(o-s)+v):Ln(Ln(v-s)+o),o=s,e=Ln(e+a)),i+=f;return Ln(u+Ln(o+e))})),v(jf,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return nr(n[t])?u:n[t];for(e=t,i=0;i<r;i++)!1===nr(n[e])&&(u=Ln(u+n[e])),e+=f;return u})),v(Ff,"ndarray",Sf),v(Tf,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return n;if(a=w(r/2),e=t,1===f){if(i=e+r-1,(o=a%3)>0)for(c=0;c<o;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;if(a<3)return n;for(c=o;c<a;c+=3)u=n[e],n[e]=n[i],n[i]=u,u=n[e+1],n[e+1]=n[i-1],n[i-1]=u,u=n[e+2],n[e+2]=n[i-2],n[i-2]=u,e+=3,i-=3;return n}for(i=e+(r-1)*f,c=0;c<a;c++)u=n[e],n[e]=n[i],n[i]=u,e+=f,i-=f;return n}));var If="function"==typeof Uint32Array,Of="function"==typeof Uint32Array?Uint32Array:null,Ef="function"==typeof Uint32Array?Uint32Array:void 0,Nf=function(){var r,n,f;if("function"!=typeof Of)return!1;try{n=new Of(n=[1,3.14,-3.14,4294967296,4294967297]),f=n,r=(If&&f instanceof Uint32Array||"[object Uint32Array]"===qn(f))&&1===n[0]&&3===n[1]&&4294967293===n[2]&&0===n[3]&&1===n[4]}catch(n){r=!1}return r}()?Ef:function(){throw new Error("not implemented")},Pf=new Jn(1);new Nf(Pf.buffer)[0]=2139095040;var Uf=Pf[0];function Mf(r){return 0===r&&1/r===Uf}function Vf(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,p=r,a=w(r/2);;){if(a>0)d=f[i+(a-=1)*t],y=u[o+a*e];else{if(0==(p-=1))return f;d=f[l=i+p*t],y=u[m=o+p*e],f[l]=f[i],u[m]=u[o]}for(c=2*(b=a)+1;c<p&&((g=c+1)<p&&((s=f[i+g*t])>(v=f[i+c*t])||nr(s)||s===v&&Mf(s))&&(c+=1),(s=f[i+c*t])>d||nr(s)||s===d&&Mf(s));)f[i+b*t]=s,u[o+b*e]=u[o+c*e],c=2*(b=c)+1;f[i+b*t]=d,u[o+b*e]=y}}v(Vf,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),p=r,a=w(r/2);;){if(a>0)d=f[u+(a-=1)*t],y=e[o+a*i];else{if(0==(p-=1))return f;d=f[l=u+p*t],y=e[m=o+p*i],f[l]=f[u],e[m]=e[o]}for(c=2*(b=a)+1;c<p&&((g=c+1)<p&&((s=f[u+g*t])>(v=f[u+c*t])||nr(s)||s===v&&Mf(s))&&(c+=1),(s=f[u+c*t])>d||nr(s)||s===d&&Mf(s));)f[u+b*t]=s,e[o+b*i]=e[o+c*i],c=2*(b=c)+1;f[u+b*t]=d,e[o+b*i]=y}}));var Gf=new Jn(1);new Nf(Gf.buffer)[0]=4286578688;var Bf=Gf[0];function Yf(r){return 0===r&&1/r===Bf}function Cf(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m,p,b,g;if(r<=0||0===n)return f;if(n<0&&(t*=-1,e*=-1),e<0?(y=(1-r)*e,l=0):(y=0,l=(r-1)*e),v=y+e,t<0){for(s=0,o=(c=(1-r)*t)+t,g=1;g<r;g++)if(m=f[o],p=u[v],nr(m)){for(a=o,d=v;a>s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=Yf(m),a=o-t,d=v-e;a<=c&&(!((b=f[a])<=m)||i&&b===m&&!1===Yf(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}for(s=(r-1)*t,o=(c=0)+t,g=1;g<r;g++)if(m=f[o],p=u[v],nr(m)){for(a=o,d=v;a<s;)f[a]=f[a+t],u[d]=u[d+e],a+=t,d+=e;f[s]=m,u[l]=p}else{for(i=Yf(m),a=o-t,d=v-e;a>=c&&(!((b=f[a])<=m)||i&&b===m&&!1===Yf(b));)f[a+t]=b,u[d+e]=u[d],a-=t,d-=e;f[a+t]=m,u[d+e]=p,o+=t,v+=e}return f}v(Cf,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m,p,b,g,w,h;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),d=(v=u)+(r-1)*t,c=v+t,p=(m=o)+(r-1)*i,y=m+i,t<0){for(h=1;h<r;h++)if(b=f[c],g=e[y],nr(b)){for(s=c,l=y;s>d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=Yf(b),s=c-t,l=y-i;s<=v&&(!((w=f[s])<=b)||a&&w===b&&!1===Yf(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}for(h=1;h<r;h++)if(b=f[c],g=e[y],nr(b)){for(s=c,l=y;s<d;)f[s]=f[s+t],e[l]=e[l+i],s+=t,l+=i;f[d]=b,e[p]=g}else{for(a=Yf(b),s=c-t,l=y-i;s>=v&&(!((w=f[s])<=b)||a&&w===b&&!1===Yf(w));)f[s+t]=w,e[l+i]=e[l],s-=t,l-=i;f[s+t]=b,e[l+i]=g,c+=t,y+=i}return f}));var qf=[701,301,132,57,23,10,4,1],zf=qf.length;function Df(r,n,f,t,u,e){var i,o,a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(t*=-1,e*=-1),i=t<0?(1-r)*t:0,o=e<0?(1-r)*e:0,y=0;y<zf;y++)for(l=c=qf[y];l<r;l++)if(!nr(s=f[i+l*t])){for(v=u[o+l*e],a=Yf(s),m=l;m>=c&&(!((d=f[i+(m-c)*t])<=s)||a&&d===s);m-=c)f[i+m*t]=d,u[o+m*e]=u[o+(m-c)*e];f[i+m*t]=s,u[o+m*e]=v}return f}var Hf=qf.length;function Jf(r,n,f,t){var u,e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=r,e=w(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||nr(o)||o===a&&Mf(o))&&(i+=1),(o=f[u+i*t])>s||nr(o)||o===s&&Mf(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}}function Kf(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;if(n<0&&(t*=-1),t<0){for(a=0,e=(o=(1-r)*t)+t,v=1;v<r;v++)if(nr(c=f[e])){for(i=e;i>a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=Yf(c),i=e-t;i<=o&&(!((s=f[i])<=c)||u&&s===c&&!1===Yf(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}for(a=(r-1)*t,e=(o=0)+t,v=1;v<r;v++)if(nr(c=f[e])){for(i=e;i<a;)f[i]=f[i+t],i+=t;f[a]=c}else{for(u=Yf(c),i=e-t;i>=o&&(!((s=f[i])<=c)||u&&s===c&&!1===Yf(s));)f[i+t]=s,i-=t;f[i+t]=c,e+=t}return f}v(Df,"ndarray",(function(r,n,f,t,u,e,i,o){var a,c,s,v,d,y,l,m;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1),o-=(r-1)*(i*=-1)),y=0;y<Hf;y++)for(l=c=qf[y];l<r;l++)if(!nr(s=f[u+l*t])){for(v=e[o+l*i],a=Yf(s),m=l;m>=c&&(!((d=f[u+(m-c)*t])<=s)||a&&d===s);m-=c)f[u+m*t]=d,e[o+m*i]=e[o+(m-c)*i];f[u+m*t]=s,e[o+m*i]=v}return f})),v(Jf,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d,y;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=r,e=w(r/2);;){if(e>0)s=f[u+(e-=1)*t];else{if(0==(c-=1))return f;s=f[v=u+c*t],f[v]=f[u]}for(i=2*(d=e)+1;i<c&&((y=i+1)<c&&((o=f[u+y*t])>(a=f[u+i*t])||nr(o)||o===a&&Mf(o))&&(i+=1),(o=f[u+i*t])>s||nr(o)||o===s&&Mf(o));)f[u+d*t]=o,i=2*(d=i)+1;f[u+d*t]=s}})),v(Kf,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(r<=0||0===n)return f;if(n<0&&(u-=(r-1)*(t*=-1)),c=(a=u)+(r-1)*t,i=a+t,t<0){for(d=1;d<r;d++)if(nr(s=f[i])){for(o=i;o>c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=Yf(s),o=i-t;o<=a&&(!((v=f[o])<=s)||e&&v===s&&!1===Yf(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}for(d=1;d<r;d++)if(nr(s=f[i])){for(o=i;o<c;)f[o]=f[o+t],o+=t;f[c]=s}else{for(e=Yf(s),o=i-t;o>=a&&(!((v=f[o])<=s)||e&&v===s&&!1===Yf(v));)f[o+t]=v,o-=t;f[o+t]=s,i+=t}return f}));var Lf=[701,301,132,57,23,10,4,1],Qf=Lf.length;function Rf(r,n,f,t){var u,e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(t*=-1),u=t<0?(1-r)*t:0,c=0;c<Qf;c++)for(s=i=Lf[c];s<r;s++)if(!nr(o=f[u+s*t])){for(e=Yf(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f}var Wf=Lf.length;function Xf(r,n,f){var t,u,e,i,o,a;if(r<=0)return 0;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,t=0,o=0,a=0;a<r;a++)e=n[u],i=Ln(t+e),o=y(t)>=y(e)?Ln(o+Ln(Ln(t-i)+e)):Ln(o+Ln(Ln(e-i)+t)),t=i,u+=f;return Ln(t+o)}function Zf(r,n,f,t){var u,e,i,o,a,c;if(r<=0)return 0;if(1===r||0===f)return n[t];for(e=t,u=0,a=0,c=0;c<r;c++)i=n[e],o=Ln(u+i),a=y(u)>=y(i)?Ln(a+Ln(Ln(u-o)+i)):Ln(a+Ln(Ln(i-o)+u)),u=o,e+=f;return Ln(u+a)}function $f(r,n,f){return Xf(r,n,f)}function rt(r,n,f){var t,u,e,i,o,a,c,s,v;if(r<=0)return 0;if(1===r||0===f)return n[0];for(e=f<0?(1-r)*f:0,t=0,u=0,i=0,v=0;v<r;v++)a=n[e],c=Ln(t+a),s=y(t)>=y(a)?Ln(Ln(t-c)+a):Ln(Ln(a-c)+t),t=c,c=Ln(i+s),o=y(i)>=y(s)?Ln(Ln(i-c)+s):Ln(Ln(s-c)+i),i=c,u=Ln(u+o),e+=f;return Ln(t+Ln(i+u))}function nt(r,n,f){var t,u,e;if(t=0,r<=0)return t;if(1===r||0===f)return n[0];for(u=f<0?(1-r)*f:0,e=0;e<r;e++)t=Ln(t+n[u]),u+=f;return t}function ft(r,n,f,t){var u,e,i,o,a,c,s,v,d,y,l,m,p;if(r<=0)return 0;if(1===r||0===f)return n[t];if(u=t,r<8){for(l=0,p=0;p<r;p++)l=Ln(l+n[u]),u+=f;return l}if(r<=128){for(e=n[u],i=n[u+f],o=n[u+2*f],a=n[u+3*f],c=n[u+4*f],s=n[u+5*f],v=n[u+6*f],d=n[u+7*f],u+=8*f,y=r%8,p=8;p<r-y;p+=8)e=Ln(e+n[u]),i=Ln(i+n[u+f]),o=Ln(o+n[u+2*f]),a=Ln(a+n[u+3*f]),c=Ln(c+n[u+4*f]),s=Ln(s+n[u+5*f]),v=Ln(v+n[u+6*f]),d=Ln(d+n[u+7*f]),u+=8*f;for(l=Ln(Ln(Ln(e+i)+Ln(o+a))+Ln(Ln(c+s)+Ln(v+d)));p<r;p++)l=Ln(l+n[u]),u+=f;return l}return m=w(r/2),Ln(ft(m-=m%8,n,f,u)+ft(r-m,n,f,u+m*f))}function tt(r,n,f){var t,u,e;if(r<=0)return 0;if(1===r||0===f)return n[0];if(t=f<0?(1-r)*f:0,r<8){for(u=0,e=0;e<r;e++)u=Ln(u+n[t]),t+=f;return u}return ft(r,n,f,t)}v(Rf,"ndarray",(function(r,n,f,t,u){var e,i,o,a,c,s,v;if(r<=0||0===n)return f;for(n<0&&(u-=(r-1)*(t*=-1)),c=0;c<Wf;c++)for(s=i=Lf[c];s<r;s++)if(!nr(o=f[u+s*t])){for(e=Yf(o),v=s;v>=i&&(!((a=f[u+(v-i)*t])<=o)||e&&a===o);v-=i)f[u+v*t]=a;f[u+v*t]=o}return f})),v(Xf,"ndarray",Zf),v($f,"ndarray",(function(r,n,f,t){return Zf(r,n,f,t)})),v(rt,"ndarray",(function(r,n,f,t){var u,e,i,o,a,c,s,v,d;if(r<=0)return 0;if(1===r||0===f)return n[t];for(i=t,u=0,e=0,o=0,d=0;d<r;d++)c=n[i],s=Ln(u+c),v=y(u)>=y(c)?Ln(Ln(u-s)+c):Ln(Ln(c-s)+u),u=s,s=Ln(o+v),a=y(o)>=y(v)?Ln(Ln(o-s)+v):Ln(Ln(v-s)+o),o=s,e=Ln(e+a),i+=f;return Ln(u+Ln(o+e))})),v(nt,"ndarray",(function(r,n,f,t){var u,e,i;if(u=0,r<=0)return u;if(1===r||0===f)return n[t];for(e=t,i=0;i<r;i++)u=Ln(u+n[e]),e+=f;return u})),v(tt,"ndarray",ft);var ut={};s(ut,"dapx",d),s(ut,"dapxsum",p),s(ut,"dapxsumkbn",l),s(ut,"dapxsumkbn2",b),s(ut,"dapxsumors",g),s(ut,"dapxsumpw",_),s(ut,"dasumpw",x),s(ut,"dcusum",S),s(ut,"dcusumkbn",A),s(ut,"dcusumkbn2",F),s(ut,"dcusumors",T),s(ut,"dcusumpw",O),s(ut,"dfill",E),s(ut,"dnanasum",M),s(ut,"dnanasumors",P),s(ut,"dnannsum",B),s(ut,"dnannsumkbn",V),s(ut,"dnannsumkbn2",Y),s(ut,"dnannsumors",C),s(ut,"dnannsumpw",z),s(ut,"dnansum",J),s(ut,"dnansumkbn",D),s(ut,"dnansumkbn2",K),s(ut,"dnansumors",L),s(ut,"dnansumpw",R),s(ut,"drev",W),s(ut,"dsapxsum",$),s(ut,"dsapxsumpw",Z),s(ut,"dsnannsumors",rr),s(ut,"dsnansum",ur),s(ut,"dsnansumors",er),s(ut,"dsnansumpw",tr),s(ut,"dsort2hp",ar),s(ut,"dsort2ins",vr),s(ut,"dsort2sh",lr),s(ut,"dsorthp",pr),s(ut,"dsortins",br),s(ut,"dsortsh",hr),s(ut,"dssum",Ar),s(ut,"dssumors",jr),s(ut,"dssumpw",xr),s(ut,"dsum",Tr),s(ut,"dsumkbn",Sr),s(ut,"dsumkbn2",Ir),s(ut,"dsumors",Or),s(ut,"dsumpw",Nr),s(ut,"gapx",Pr),s(ut,"gapxsum",Vr),s(ut,"gapxsumkbn",Ur),s(ut,"gapxsumkbn2",Gr),s(ut,"gapxsumors",Br),s(ut,"gapxsumpw",Cr),s(ut,"gasumpw",zr),s(ut,"gcusum",Jr),s(ut,"gcusumkbn",Dr),s(ut,"gcusumkbn2",Kr),s(ut,"gcusumors",Lr),s(ut,"gcusumpw",Rr),s(ut,"gfill",fn),s(ut,"gfillBy",un),s(ut,"gnannsumkbn",(function(r,n,f,t,u){var e,i,o,a,c,s,v,d;if(i=f<0?(1-r)*f:0,o=u<0?-u:0,e=0,r<=0)return t[o]=e,t[o+u]=0,t;if(1===r||0===f)return N(n[i])?(t[o]=e,t[o+u]=0,t):(t[o]=n[i],t[o+u]=1,t);for(s=0,v=0,d=0;d<r;d++)!1===N(a=n[i])&&(c=e+a,y(e)>=y(a)?s+=e-c+a:s+=a-c+e,e=c,v+=1),i+=f;return t[o]=e+s,t[o+u]=v,t})),s(ut,"gnansum",an),s(ut,"gnansumkbn",en),s(ut,"gnansumkbn2",cn),s(ut,"gnansumors",sn),s(ut,"gnansumpw",dn),s(ut,"grev",ln),s(ut,"gsort2hp",mn),s(ut,"gsort2ins",pn),s(ut,"gsort2sh",wn),s(ut,"gsorthp",_n),s(ut,"gsortins",kn),s(ut,"gsortsh",jn),s(ut,"gsum",In),s(ut,"gsumkbn",Fn),s(ut,"gsumkbn2",On),s(ut,"gsumors",En),s(ut,"gsumpw",Pn),s(ut,"sapx",Un),s(ut,"sapxsum",Wn),s(ut,"sapxsumkbn",Qn),s(ut,"sapxsumkbn2",Xn),s(ut,"sapxsumors",Zn),s(ut,"sapxsumpw",rf),s(ut,"sasumpw",ff),s(ut,"scusum",ef),s(ut,"scusumkbn",tf),s(ut,"scusumkbn2",of),s(ut,"scusumors",af),s(ut,"scusumpw",sf),s(ut,"sdsapxsum",yf),s(ut,"sdsapxsumpw",df),s(ut,"sdsnansum",pf),s(ut,"sdsnansumpw",mf),s(ut,"sdssum",wf),s(ut,"sdssumpw",gf),s(ut,"sfill",hf),s(ut,"snansum",xf),s(ut,"snansumkbn",_f),s(ut,"snansumkbn2",Af),s(ut,"snansumors",jf),s(ut,"snansumpw",Ff),s(ut,"srev",Tf),s(ut,"ssort2hp",Vf),s(ut,"ssort2ins",Cf),s(ut,"ssort2sh",Df),s(ut,"ssorthp",Jf),s(ut,"ssortins",Kf),s(ut,"ssortsh",Rf),s(ut,"ssum",$f),s(ut,"ssumkbn",Xf),s(ut,"ssumkbn2",rt),s(ut,"ssumors",nt),s(ut,"ssumpw",tt);var et={};s(et,"base",ut),r.base=ut,r.default=et,Object.defineProperty(r,"__esModule",{value:!0})},"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((r="undefined"!=typeof globalThis?globalThis:r||self).extblas={});
//# sourceMappingURL=browser.js.map
